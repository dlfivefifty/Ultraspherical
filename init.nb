(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    113841,       3035]
NotebookOptionsPosition[    111878,       2963]
NotebookOutlinePosition[    112235,       2979]
CellTagsIndexPosition[    112192,       2976]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.549774017545526*^9, 3.549774018174136*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<Ultraspherical`\>\"", ",", "\"\<RiemannHilbert`Common`\>\""}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BandedOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReplaceEntry", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseLength", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyToRows", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LowerIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseSize", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetRowGenerator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFillValue", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Filler", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Givens", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GivensReduce", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DerivativeOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConversionOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DirichletOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IdentityOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ZeroOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LaplaceOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListRowReduce", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightHandSide", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549774006769565*^9, 3.5497740425113487`*^9}, {
  3.549774194301442*^9, 3.549774247624267*^9}, {3.5497743157770653`*^9, 
  3.549774324512239*^9}, {3.5497744997292747`*^9, 3.549774502961854*^9}, {
  3.549850171344842*^9, 3.54985017293055*^9}, {3.549850686637794*^9, 
  3.549850687100556*^9}, {3.549852829070692*^9, 3.549852833543066*^9}, {
  3.5498536414084997`*^9, 3.5498536672658854`*^9}, {3.550117875337818*^9, 
  3.550117882095316*^9}, {3.5501184859477167`*^9, 3.550118488394932*^9}, {
  3.550176224408351*^9, 3.550176228807666*^9}, {3.550178654735545*^9, 
  3.550178663063488*^9}, {3.550258672098682*^9, 3.5502586742161093`*^9}, {
  3.5503455450812597`*^9, 3.550345547671606*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BandedOperator", "Section",
 CellChangeTimes->{{3.547772351244157*^9, 3.5477723528270407`*^9}, {
  3.549773847264189*^9, 3.549773848259179*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", "___"}], 
      "]"}], ",", "i_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", ">", 
      RowBox[{"Length", "[", "fill", "]"}]}], ",", 
     RowBox[{"0", " ", 
      RowBox[{"First", "[", "fill", "]"}]}], ",", 
     RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
       RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ".", 
    RowBox[{"fls", "[", "j", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
       "opts___"}], "]"}], ",", "i_", ",", "val_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{"A", ",", "jsh", ",", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"fill", ",", 
       RowBox[{"i", "\[Rule]", "val"}]}], "]"}], ",", "rowgen", ",", "opts"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetRowGenerator", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", "___"}], 
      "]"}], "]"}], ":=", "rowgen"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   
   RowBox[{"\[Piecewise]", GridBox[{
      {
       RowBox[{
        RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", 
         RowBox[{"j", "-", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
         "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{"GetFillValue", "[", 
        RowBox[{"bnd", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{"j", ">", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "i", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"j", "-", 
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"LeftIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
        "\[LessEqual]", 
        RowBox[{"RightIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}]}]},
      {"0", "True"}
     }]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_List", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"bnd", "\[LeftDoubleBracket]", 
      RowBox[{"#", ",", "j"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
    "i"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", 
     RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", "j_Integer"}], 
    "\[RightDoubleBracket]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "im", ",", "iM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", 
      RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "im", ",", "iM"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"1", "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftIndex", "[", 
    RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"row", "+", 
      RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightIndex", "[", 
     RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LeftIndex", "[", 
      RowBox[{"bnd", ",", "row"}], "]"}], "+", 
     RowBox[{"\[Piecewise]", GridBox[{
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "row", 
           "\[RightDoubleBracket]"}], "]"}], 
         RowBox[{"row", "\[LessEqual]", 
          RowBox[{"Length", "[", "bnd", "]"}]}]},
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "row", "]"}], 
          "]"}], "True"}
       }]}], "-", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerIndex", "[", 
     RowBox[{"bnd_BandedMatrix", ",", "col_"}], "]"}], ":=", 
    RowBox[{"col", "-", 
     RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bandwidth", "[", "bnd_BandedOperator", "]"}], ":=", 
    RowBox[{
     RowBox[{"RightBandwidth", "[", "bnd", "]"}], "-", 
     RowBox[{"LeftBandwidth", "[", "bnd", "]"}], "+", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"Length", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"Length", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "A", "]"}], ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], "+", 
       RowBox[{"Length", "[", "A", "]"}], "-", "jsh"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToArray", "[", "bnd_BandedOperator", "]"}], ":=", 
   RowBox[{"bnd", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{
       RowBox[{"Dimensions", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"MatrixForm", "[", "bnd_BandedOperator", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "===", "Null"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{
             RowBox[{"Length", "[", "bnd", "]"}], "+", "3"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncreaseLength", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
       "opts___"}], "]"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"A", ",", 
        RowBox[{"{", 
         RowBox[{"rowgen", "[", 
          RowBox[{
           RowBox[{"Length", "[", "A", "]"}], "+", "1"}], "]"}], "}"}]}], 
       "]"}], ",", "jsh", ",", 
      RowBox[{"Append", "[", 
       RowBox[{"fill", ",", 
        RowBox[{"0", " ", 
         RowBox[{"Last", "[", "fill", "]"}]}]}], "]"}], ",", "rowgen", ",", 
      "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "Length", " ", "to", " ", "be", " ", "at", " ", 
    "least", " ", "n"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IncreaseLength", "[", 
    RowBox[{"bnd_BandedOperator", ",", "n_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "bnd", "]"}], "\[GreaterEqual]", "n"}], ",", 
     "bnd", ",", 
     RowBox[{"IncreaseLength", "[", 
      RowBox[{
       RowBox[{"bnd", "//", "IncreaseLength"}], ",", "n"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzmtIk3EUBvA1LaQlgYQVUShvFFpeSosaCr1Ts5uVOuZaYbpXs1K3qdMp
OpDausyyWMsoLa1pbDaX9qE0XEpJiVK6yZaUZEXlLTYYmhPSep//h8MPnvMc
OKFSeVoul8PhxLADqycmw0Zk0/Su4eF98OjPywyUzDnzoE5jfOFiXZNtJQrL
SmzQoG0hSpQZpTz5NK0/rSJG7nWs2syqSPEQm3T5fqbiaboz7hrRkruwGq4Q
5QRBBcXdA0OoEOIh9Y502GiNEMKb8UEn4bA8gYH+pTvPwUe9sQoojbSXwTrB
LxX0O9VRRfr9RWqY1CXWwnVDRqI4S6WD6qgBPSyvOnYX7q/ccA8KX35/AH2d
1c3w1j+xCVbXrB+BEp7JQ/qBf2ZhaqiNZ2a9Yh4MhLGHMynIN3K2wEXKEAPb
t40TGemXODipWZYIk2rrD8C+rb8Pkrv+xAwosz3Ogt1+5/Ngs8xdAq3OwQqy
D75UCXNNcg0U/qgl9gVEXYWCeK+B5OMrG6Am+nYLTKTsZrj93UcrDDZOOKEr
LmcUSrs/jcFCfttX2LHWMdvDWlwkm4ObChvD37AmW0aJ7c4U+j3rM+a+ED5s
+iaGyW0JJ6B2bEYJy1/bKyCzdOQCbMo0X4TKguc6WPc3ogZmewQ3oGT3Zz3U
XJ+ph4J0biP8QFMuuPRWTyzbOHXcAdPCUuGZ3lciOKSlM0iu8N6B89aABui/
2Go7W8L+1eztgfzogal8VlEQ44ZP6zLnoa9r1geXL7Q+KWANd/Ms8D+t9bXJ

  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "Row", " ", "Length", " ", "at", " ", "i", " ", "to",
     " ", "be", " ", "at", " ", "least", " ", "j"}], " ", "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseRightIndex", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
         "A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_", ",", 
          "opts___"}], "]"}]}], ",", "i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
         "bnd", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"bnd", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"RightIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IncreaseRightIndex", "[", 
           RowBox[{
            RowBox[{"BandedOperator", "[", 
             RowBox[{
             "B", ",", "jsh", ",", "fil", ",", "rowgen", ",", "opts"}], "]"}],
             ",", "i", ",", "j"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseRowLength", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
         "A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_", ",", 
          "opts___"}], "]"}]}], ",", "i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{
           "A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "]"}]}], ",", "\[IndentingNewLine]", "bnd", "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"bnd", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"RightIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IncreaseRowLength", "[", 
           RowBox[{
            RowBox[{"BandedOperator", "[", 
             RowBox[{
             "B", ",", "jsh", ",", "fil", ",", "rowgen", ",", "opts"}], "]"}],
             ",", "i", ",", "j"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseDimension", "[", 
      RowBox[{"bnd_BandedOperator", ",", 
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "Bn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn", "=", 
         RowBox[{"IncreaseLength", "[", 
          RowBox[{"bnd", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Bn", "=", 
            RowBox[{"IncreaseRowLength", "[", 
             RowBox[{"Bn", ",", "i", ",", "n"}], "]"}]}], ";"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "m"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "Bn"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceEntry", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
         "A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_", ",", 
          RowBox[{"fls", ":", 
           RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", "p_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"IncreaseSize", "\[Rule]", "False"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B", ",", "nfil"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "<", 
           RowBox[{"LeftIndex", "[", 
            RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "\"\<left of left entry\>\"", "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", ">", 
           RowBox[{"Length", "[", "A", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{
             RowBox[{"bnd", "//", "IncreaseLength"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], 
            "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
            
            RowBox[{
             RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", 
                RowBox[{"j", "-", 
                 RowBox[{"LeftIndex", "[", 
                  RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
               "\[RightDoubleBracket]"}], "=", "p"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"BandedOperator", "[", 
              RowBox[{
              "B", ",", "jsh", ",", "fil", ",", "rowgen", ",", "fls"}], 
              "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"ReplaceEntry", "[", 
              RowBox[{
               RowBox[{"IncreaseRightIndex", "[", 
                RowBox[{"bnd", ",", "i", ",", "j"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", "Bn_BandedOperator", ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "Bn1", ",", "rhs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"vals", "=", 
            RowBox[{"G", ".", 
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Bn1", "=", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{"Bn1", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "i"}], "}"}], ",", 
              RowBox[{
              "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Bn1", "=", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{"Bn1", ",", 
              RowBox[{"{", 
               RowBox[{"row2", ",", "i"}], "}"}], ",", 
              RowBox[{
              "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"vals", "=", 
         RowBox[{"G", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GetFill", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"GetFill", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row1", ",", 
           RowBox[{
           "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row2", ",", 
           RowBox[{
           "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", "Bn1", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rhs", "=", 
            RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"row1", ",", "row2"}], "]"}], ">", 
              RowBox[{"Length", "[", "rhs", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rhs", "=", 
               RowBox[{"PadRight", "[", 
                RowBox[{"rhs", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"row1", ",", "row2"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rhs", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], "\[RightDoubleBracket]"}],
             "=", 
            RowBox[{"G", ".", 
             RowBox[{"rhs", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"Bn1", ",", "rhs"}], "}"}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQPTm/Y9fKoleObhab94Forg35Z0H0vE3eV0G0rN7N
pyB6qnbyMxD95VfPtoNAWuEq63YQfSbvfPRZIL1n4594EG0c9HsHiNatqtoL
ohnFNf+CaAED/f8g+r7aY7ZzQPr7ixgOEF3HWHkRRLMtVLgEovOcz/zMLn7l
eG91/m8QHVO/tywHSP8+o1oJoqVm36oF0X5VnHUg+k9Kaz+I1vpkNBFEq6lv
mgqiJ4VzLQLRXs6TWHKBNNOcGWD6T6XjcRC9THIymOZa/Fp0P5Cu8vgsCaJZ
7BxUQfS9Fn9TMM1SVQOieZbItYBoAFi0oOo=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", "jsh", ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"rowgen", "[", "#", "]"}]}], "&"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "Null", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", "jsh", ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", "Null", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bndA", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "jsh_", ",", "fill1_List", ",", "Null", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"bndB", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"B_List", ",", "jsh_", ",", "fill2_List", ",", "Null", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bnA", ",", "bnB"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bnA", "=", 
        RowBox[{"IncreaseDimension", "[", 
         RowBox[{"bndA", ",", 
          RowBox[{"B", "//", "Dimensions"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bnB", "=", 
        RowBox[{"IncreaseDimension", "[", 
         RowBox[{"bndB", ",", 
          RowBox[{"A", "//", "Dimensions"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "bnA", "]"}], "+", 
          RowBox[{"First", "[", "bnB", "]"}]}], ",", "jsh", ",", 
         RowBox[{
          RowBox[{
          "bnA", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
          
          RowBox[{
          "bnB", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         ",", "  ", "Null", ",", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"bndA", ":", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{"A_List", ",", "jsh_", ",", "fill1_List", ",", 
        RowBox[{"rowgen1_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"#", "===", "Null"}], ")"}]}], "&"}], ")"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"bndB", ":", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{"B_List", ",", "jsh_", ",", "fill2_List", ",", "rowgen2_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bnA", ",", "bnB", ",", "rowlength"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bnA", "=", 
       RowBox[{"IncreaseDimension", "[", 
        RowBox[{"bndA", ",", 
         RowBox[{"B", "//", "Dimensions"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bnB", "=", 
       RowBox[{"IncreaseDimension", "[", 
        RowBox[{"bndB", ",", 
         RowBox[{"A", "//", "Dimensions"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rowlength", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "bnA", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "//", "Length"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "bnA", "]"}], "+", 
         RowBox[{"First", "[", "bnB", "]"}]}], ",", "jsh", ",", 
        RowBox[{
         RowBox[{
         "bnA", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
         RowBox[{
         "bnB", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], ",",
         "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"rowgen1", "[", "#", "]"}], ",", "rowlength"}], "]"}], 
          "+", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{"rowgen2", "[", "#", "]"}], ",", "rowlength"}], "]"}]}], 
         "&"}], ",", "opts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549666178987925*^9, 3.5496662147884417`*^9}, {
  3.549666248709485*^9, 3.5496662603725348`*^9}, {3.549773972202506*^9, 
  3.549773973201696*^9}, {3.549822934343738*^9, 3.549822935198258*^9}, {
  3.5498594462553062`*^9, 3.5498595264925413`*^9}, {3.549861222061997*^9, 
  3.549861251218501*^9}, {3.550168895942987*^9, 3.550168907036255*^9}, {
  3.5501781157155743`*^9, 3.550178300493618*^9}, {3.550178346215003*^9, 
  3.5501783617976513`*^9}, {3.550179073774878*^9, 3.550179142206407*^9}, {
  3.550179466630992*^9, 3.5501794695855*^9}, {3.5501795154550257`*^9, 
  3.550179552564497*^9}, {3.550179858941573*^9, 3.550179865460219*^9}, {
  3.5501799745972958`*^9, 3.550180101743847*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.55018008189603*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.550180005369152*^9, 3.550180005975665*^9}, {
  3.550180084808528*^9, 3.5501800888800507`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["OperatorEntry Routines", "Section",
 CellChangeTimes->{{3.549822480961389*^9, 3.549822486232541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowZeroQ", "[", 
    RowBox[{"0", ",", "_"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RowZeroQ", "[", 
     RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"row", "\[LessEqual]", 
           RowBox[{"Length", "[", "bnd", "]"}]}], ",", "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", 
             "row", "\[RightDoubleBracket]"}], ",", 
            RowBox[{"GetFill", "[", 
             RowBox[{"bnd", ",", "row"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "row", "]"}], 
           "}"}]}], "]"}], "//", "Flatten"}], "//", "Abs"}], "//", "Total"}], 
     "//", "NZeroQ"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", "Bn_BandedOperator", ",", "Bnn_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vals", ",", "Bn1", ",", "Bn2", ",", "i", ",", "rhs1", ",", "rhs2"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bnn"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NZeroQ", "[", 
                RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                 RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], "]"}],
                "&&", 
               RowBox[{"NZeroQ", "[", 
                RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                 RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}], 
                "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vals", "=", 
              RowBox[{"G", ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                  RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                 
                 RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                  RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                 RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Bn1", "=", 
                 RowBox[{"ReplaceEntry", "[", 
                  RowBox[{"Bn1", ",", 
                   RowBox[{"{", 
                    RowBox[{"row1", ",", "i"}], "}"}], ",", 
                   RowBox[{
                   "vals", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                 RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Bn2", "=", 
                 RowBox[{"ReplaceEntry", "[", 
                  RowBox[{"Bn2", ",", 
                   RowBox[{"{", 
                    RowBox[{"row2", ",", "i"}], "}"}], ",", 
                   RowBox[{
                   "vals", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"G", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", "Null"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"rhs1", ",", "rhs2"}], "}"}], "=", 
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"rhs1", "=", 
           RowBox[{"PadRight", "[", 
            RowBox[{"rhs1", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"row1", ",", 
               RowBox[{"Length", "[", "rhs1", "]"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rhs2", "=", 
           RowBox[{"PadRight", "[", 
            RowBox[{"rhs2", ",", 
             RowBox[{"Max", "[", 
              RowBox[{"row2", ",", 
               RowBox[{"Length", "[", "rhs2", "]"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "rhs1", "\[LeftDoubleBracket]", "row1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "rhs2", "\[LeftDoubleBracket]", "row2", 
              "\[RightDoubleBracket]"}]}], "}"}], "=", 
           RowBox[{"G", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "rhs1", "\[LeftDoubleBracket]", "row1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "rhs2", "\[LeftDoubleBracket]", "row2", 
               "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"rhs1", ",", "rhs2"}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "operator", " ", "of", " ", 
    "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "i", ",", "rhs", ",", 
       "rhs1", ",", "rhs2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"Bn1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", "B1", ",", "B2", ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", "B2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", "Null"}], 
        ",", "\[IndentingNewLine]", "Bn1", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rhs", "=", 
          RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"rhs1", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"Max", "[", 
             RowBox[{"row1", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
               "rhs", "\[LeftDoubleBracket]", "row1", 
                "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rhs2", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"Max", "[", 
             RowBox[{"row2", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
               "rhs", "\[LeftDoubleBracket]", "row2", 
                "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}],
             ",", 
            RowBox[{
            "rhs2", "\[LeftDoubleBracket]", "row2", 
             "\[RightDoubleBracket]"}]}], "}"}], "=", 
          RowBox[{"G", ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "rhs1", "\[LeftDoubleBracket]", "row1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "rhs2", "\[LeftDoubleBracket]", "row2", 
              "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
          "=", "rhs1"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "rhs", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
          "=", "rhs2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Bn1", ",", "rhs"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ3ZFpFTCv6JXjbLn3wSBa16nbYT6QLphs4Q6iTZ7q
+oDo5G0n/ED0HX6/ffuB9KKY52D6/Fe9EyCaX/PjBRB9iOP8VRC9TP3MdRD9
O/LcbRDdfZn9KYg23PJi+0EgbeoyeweI/nZ+/ptzQFrK1OQbiObrbzc4D6S/
8PWC6QlMJXYgWjy1yAFE5wltdwHRkw7UuoFoUTexwJDiV44K26LDQHTXzbl5
IPrD1PcFILru77FyEH3P6yyYFtV61w6i/frWdoBowcufJ4JoKbGqSSC6RbFt
GojO8UqaCaLPbdc1zwDSvq3XwLSNYuEmEJ33uxlML9arkCgA0kGyovIguu3j
B/ZiIF2zSZ8DRDNtWLdmP5Ce58x1EEQnnbl8CkxP7b4OogELwMkO
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
List of Operator valued BandedOperators\
\>", "Section",
 CellChangeTimes->{{3.549829941925861*^9, 3.54982995406141*^9}, {
  3.549830013863139*^9, 3.5498300142594852`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", "BDx_BandedOperator", ",", "Bd2_BandedOperator", ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "Bn2", ",", "i", ",", 
         "rhs1", ",", "rhs2", ",", "srhs1", ",", "srhs2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bn2", "=", "Bd2"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Bn1", "\[LeftDoubleBracket]", 
               RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Bn2", "\[LeftDoubleBracket]", 
               RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RowZeroQ", "[", 
                 RowBox[{"B1", ",", "srow1"}], "]"}], "&&", 
                RowBox[{"RowZeroQ", "[", 
                 RowBox[{"B2", ",", "srow2"}], "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"B1", ",", "B2"}], "}"}], "=", 
               RowBox[{"ApplyToRows", "[", 
                RowBox[{"G", ",", "B1", ",", "B2", ",", 
                 RowBox[{"{", 
                  RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Bn1", "=", 
               RowBox[{"ReplaceEntry", "[", 
                RowBox[{"Bn1", ",", 
                 RowBox[{"{", 
                  RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
                 RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Bn2", "=", 
               RowBox[{"ReplaceEntry", "[", 
                RowBox[{"Bn2", ",", 
                 RowBox[{"{", 
                  RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
                 RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B1", ",", "B2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B1", ",", "B2"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Bn2", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn2", ",", "row2", ",", "B2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rhs1", ",", "rhs2"}], "}"}], "=", 
            RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"rhs1", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{"rhs1", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"row1", ",", 
                RowBox[{"Length", "[", "rhs1", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rhs2", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{"rhs2", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"row2", ",", 
                RowBox[{"Length", "[", "rhs2", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"srhs1", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{
              "rhs1", "\[LeftDoubleBracket]", "row1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"srow1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "rhs1", "\[LeftDoubleBracket]", "row1", 
                  "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"srhs2", "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{
              "rhs2", "\[LeftDoubleBracket]", "row2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{"srow2", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "rhs2", "\[LeftDoubleBracket]", "row2", 
                  "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "srhs1", "\[LeftDoubleBracket]", "srow1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "srhs2", "\[LeftDoubleBracket]", "srow2", 
               "\[RightDoubleBracket]"}]}], "}"}], "=", 
            RowBox[{"G", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "srhs1", "\[LeftDoubleBracket]", "srow1", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "srhs2", "\[LeftDoubleBracket]", "srow2", 
                "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}],
             "=", "srhs1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "rhs2", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}],
             "=", "srhs2"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"rhs1", ",", "rhs2"}], "}"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "for", " ", "list", " ", "operators", " ", "of", 
     " ", "operators"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", 
       RowBox[{"BL", ":", 
        RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "BL"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"row1", "===", "row2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{
              "B1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"Bn1", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", "B1", ",", "B2", ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", "B1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "=", "B2"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5498299971204147`*^9, 3.549830002231*^9}, {
   3.5498300620259542`*^9, 3.549830114773*^9}, {3.549830182515881*^9, 
   3.5498303887293577`*^9}, {3.5498593176211367`*^9, 3.5498593388387737`*^9}, 
   3.55016749195546*^9, {3.5501680096337757`*^9, 3.5501680099280367`*^9}, {
   3.5501826001531*^9, 3.550182637688943*^9}, 3.550183615697843*^9, {
   3.550187827217231*^9, 3.550187830368005*^9}, {3.550187881913268*^9, 
   3.550187894167808*^9}, {3.550346973346636*^9, 3.5503470529798937`*^9}, {
   3.550347109859839*^9, 3.550347117881908*^9}, {3.5503474551916437`*^9, 
   3.550347565820326*^9}, {3.550347703926031*^9, 3.550347774637999*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Givens", "Section",
 CellChangeTimes->{{3.549852783991269*^9, 3.5498527850934362`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Givens", "[", 
    RowBox[{"Bin_", ",", "Binn_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a", ",", "bB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Bin", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bB", "=", 
       RowBox[{"Binn", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"a", "bB"},
          {
           RowBox[{"-", "bB"}], "a"}
         }], ")"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "bB"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Givens", "[", 
     RowBox[{"Bn_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", 
      "scol_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Givens", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "scol"}], "]"}], "//", 
     "N"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "row1"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "srow1"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GivensReduce", "[", 
     RowBox[{"BDx_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"Givens", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow1", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow2", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "ssrow1"}], "]"}], 
         "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", "col_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "col"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_", ",", "scol_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", "scol_"}],
     "]"}], ":=", 
   RowBox[{"ApplyToRows", "[", 
    RowBox[{
     RowBox[{"Givens", "[", 
      RowBox[{"BDx", ",", 
       RowBox[{"{", 
        RowBox[{"row1", ",", "row2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "col", ",", "scol"}], 
      "]"}], ",", "BDx", ",", 
     RowBox[{"{", 
      RowBox[{"row1", ",", "row2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549756628054965*^9, 3.549756770589405*^9}, 
   3.549822823515428*^9, {3.549826667004466*^9, 3.5498266672920227`*^9}, {
   3.5498307337308826`*^9, 3.5498308148241987`*^9}, {3.549852826370562*^9, 
   3.549852923989644*^9}, {3.549853461087563*^9, 3.5498534920722713`*^9}, {
   3.549853892662857*^9, 3.549853963029562*^9}, {3.549854300032857*^9, 
   3.549854301590097*^9}, {3.549854358701455*^9, 3.549854383645089*^9}, {
   3.550166813511777*^9, 3.5501668776717033`*^9}, {3.550183232417708*^9, 
   3.550183298642459*^9}, 3.5501833733322563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["RowReduce", "Section",
 CellChangeTimes->{{3.549852783991269*^9, 3.5498527850934362`*^9}, {
  3.550257529695962*^9, 3.550257530892642*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowReduceMatrix", "[", 
    RowBox[{"Bin_", ",", "Binn_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a", ",", "bB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Bin", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bB", "=", 
       RowBox[{"Binn", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {
          RowBox[{
           RowBox[{"-", "bB"}], "/", "a"}], "1"}
        }], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RowReduceMatrix", "[", 
     RowBox[{"Bn_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", 
      "scol_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RowReduceMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "scol"}], "]"}], "//", 
     "N"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "row1"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "srow1"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListRowReduce", "[", 
     RowBox[{"BDx_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"RowReduceMatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow1", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow2", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "ssrow1"}], "]"}], 
         "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", "col_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "col"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_", ",", "scol_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListRowReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", "scol_"}],
     "]"}], ":=", 
   RowBox[{"ApplyToRows", "[", 
    RowBox[{
     RowBox[{"RowReduceMatrix", "[", 
      RowBox[{"BDx", ",", 
       RowBox[{"{", 
        RowBox[{"row1", ",", "row2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "col", ",", "scol"}], 
      "]"}], ",", "BDx", ",", 
     RowBox[{"{", 
      RowBox[{"row1", ",", "row2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549756628054965*^9, 3.549756770589405*^9}, 
   3.549822823515428*^9, {3.549826667004466*^9, 3.5498266672920227`*^9}, {
   3.5498307337308826`*^9, 3.5498308148241987`*^9}, {3.549852826370562*^9, 
   3.549852923989644*^9}, {3.549853461087563*^9, 3.5498534920722713`*^9}, {
   3.549853892662857*^9, 3.549853963029562*^9}, {3.549854300032857*^9, 
   3.549854301590097*^9}, {3.549854358701455*^9, 3.549854383645089*^9}, {
   3.550166813511777*^9, 3.5501668776717033`*^9}, {3.550183232417708*^9, 
   3.550183298642459*^9}, 3.5501833733322563`*^9, {3.55025753238282*^9, 
   3.550257753865631*^9}, {3.550257836308195*^9, 3.550257876306402*^9}, {
   3.5502579164967413`*^9, 3.5502579280317497`*^9}, {3.550258042505392*^9, 
   3.5502580659781313`*^9}, {3.550258195326816*^9, 3.550258195843938*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives", "Section",
 CellChangeTimes->{{3.550117498093774*^9, 3.550117500418523*^9}}],

Cell[CellGroupData[{

Cell["1D", "Subsection",
 CellChangeTimes->{{3.550118929591868*^9, 3.5501189299263897`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "4"}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"#", "+", "1"}], ")"}]}]}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", "#", "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", "1", "]"}], ":=", 
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", "2", "]"}], ":=", 
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", "1", "]"}], ":=", 
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
        RowBox[{"1", "/", "6"}]}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConversionOperator", "[", "2", "]"}], ":=", 
    RowBox[{"ConversionOperator", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirichletOperator", "[", 
    RowBox[{"-", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirichletOperator", "[", "1", "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "1", "}"}], "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", "Null", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentityOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdentityOperator", "[", "]"}], ":=", 
    RowBox[{"IdentityOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"1", ",", "\[Infinity]", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]"}], "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550117506963544*^9, 3.550117539066474*^9}, {
  3.5501176899300423`*^9, 3.550117734203289*^9}, {3.5501178225619793`*^9, 
  3.550117862768076*^9}, {3.5501180056622763`*^9, 3.5501180728070927`*^9}, {
  3.5501183917352*^9, 3.550118436148741*^9}, {3.550118468240778*^9, 
  3.550118608032094*^9}, {3.5501186666017427`*^9, 3.5501186779029503`*^9}, {
  3.5501219900588503`*^9, 3.5501219935971813`*^9}, {3.550122266376645*^9, 
  3.5501222732344313`*^9}, {3.550124503332169*^9, 3.550124504158793*^9}, {
  3.550124540936901*^9, 3.550124541080565*^9}, {3.5501245715032463`*^9, 
  3.5501245934711237`*^9}, {3.550126074402755*^9, 3.5501260936703463`*^9}, {
  3.550126142629416*^9, 3.55012618345347*^9}, {3.5501787205225267`*^9, 
  3.550178770089302*^9}, {3.550188521473116*^9, 3.550188638669778*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Boundary", "Subsection",
 CellChangeTimes->{{3.550118700417121*^9, 3.550118700734531*^9}, {
  3.550121793317935*^9, 3.550121794817618*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdentityOperator", "[", "]"}], ",", 
          RowBox[{"ZeroOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null", 
       ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"1", ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", "]"}], ",", 
          RowBox[{"IdentityOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null",
        ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", "1"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "}"}], ",", "1",
        ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550118636925847*^9, 3.550118657395903*^9}, {
  3.550118713262124*^9, 3.550118916277152*^9}, {3.550120334916541*^9, 
  3.5501203751819057`*^9}, {3.5501217701479483`*^9, 3.5501217780463*^9}, {
  3.550125933742004*^9, 3.550126072224814*^9}, {3.5501261883221197`*^9, 
  3.550126196219458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Derivative", "Subsection",
 CellChangeTimes->{{3.550121800768366*^9, 3.5501218029082127`*^9}, {
  3.550121980498454*^9, 3.550121981574006*^9}, {3.550122449180884*^9, 
  3.550122452090794*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"ConversionOperator", "[", "1", "]"}], "}"}], "}"}], ",", "0", 
     ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "#", ")"}], 
        RowBox[{"ConversionOperator", "[", "1", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"1", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "1", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "1", "]"}], "/", "2"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", " ", 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"#", "+", "1"}], ")"}], 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"2", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "/", "3"}], " ", 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
       "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "#"}], ")"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
            FractionBox["1", 
             RowBox[{"2", " ", "#"}]]}], ")"}], 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         FractionBox[
          RowBox[{"DerivativeOperator", "[", "2", "]"}], 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaplaceOperator", ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"4", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"#", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
              "}"}]}], "+", 
            RowBox[{"4", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
               FractionBox["1", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}]}]}], "&"}], ",", 
          
          RowBox[{"Filler", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
            ")"}]}]}], "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
      "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "#"}], ")"}]}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
               FractionBox["1", 
                RowBox[{"2", " ", "#"}]]}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"#", "+", "1"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"rw", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ")"}], 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"rw", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
               "}"}]}], "+", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"#", "+", "1"}], ")"}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "rw"}], ")"}]}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"rw", "+", "2"}], ")"}]}]]}], "-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", "rw"}]]}], ",", "0", ",", 
                FractionBox["1", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"rw", "+", "2"}], ")"}]}]]}], "}"}]}]}]}], "]"}], 
          ",", 
          RowBox[{"Filler", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
            ")"}]}]}], "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        FractionBox[
         RowBox[{"DerivativeOperator", "[", "2", "]"}], 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550122452643403*^9, 3.550122480910864*^9}, {
  3.550122574777398*^9, 3.550122624935754*^9}, {3.550122657779542*^9, 
  3.550122734251135*^9}, {3.550124447345154*^9, 3.550124478636944*^9}, {
  3.5501246311602497`*^9, 3.550124676317891*^9}, {3.550124753191527*^9, 
  3.550124888158516*^9}, {3.55012495533981*^9, 3.550124957036583*^9}, {
  3.550124996059701*^9, 3.550125037266059*^9}, {3.550125085801772*^9, 
  3.550125108235787*^9}, {3.550125149534938*^9, 3.550125188195448*^9}, {
  3.550125245405364*^9, 3.550125274555833*^9}, {3.550125327605113*^9, 
  3.5501253976174927`*^9}, {3.550125431562579*^9, 3.5501254394278297`*^9}, {
  3.550125706552293*^9, 3.550125706916587*^9}, {3.550126203868326*^9, 
  3.550126249079026*^9}, {3.550190374550264*^9, 3.550190397382245*^9}, {
  3.5501905449613533`*^9, 3.5501905618263063`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 CellChangeTimes->{{3.549774023871806*^9, 3.549774024517992*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5497740258052588`*^9, 3.54977403320975*^9}}]
}, Open  ]]
},
WindowSize->{1882, 1323},
WindowMargins->{{244, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 90, 1, 67, "Section"],
Cell[672, 25, 2395, 42, 418, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3104, 72, 150, 2, 67, "Section"],
Cell[3257, 76, 13576, 369, 708, "Input",
 InitializationCell->True],
Cell[16836, 447, 13501, 325, 1228, "Input",
 InitializationCell->True],
Cell[30340, 774, 6086, 151, 298, "Input",
 InitializationCell->True],
Cell[36429, 927, 67, 1, 27, "Input"],
Cell[36499, 930, 197, 3, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36733, 938, 107, 1, 67, "Section"],
Cell[36843, 941, 16140, 402, 1213, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[53020, 1348, 182, 4, 67, "Section"],
Cell[53205, 1354, 12509, 298, 868, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[65751, 1657, 93, 1, 67, "Section"],
Cell[65847, 1660, 9047, 242, 536, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[74931, 1907, 145, 2, 67, "Section"],
Cell[75079, 1911, 9432, 242, 536, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[84548, 2158, 96, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[84669, 2163, 92, 1, 34, "Subsection"],
Cell[84764, 2166, 10534, 320, 408, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[95335, 2491, 148, 2, 34, "Subsection"],
Cell[95486, 2495, 4387, 127, 103, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[99910, 2627, 201, 3, 34, "Subsection"],
Cell[100114, 2632, 11363, 313, 337, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111526, 2951, 91, 1, 67, "Section"],
Cell[111620, 2954, 242, 6, 43, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
