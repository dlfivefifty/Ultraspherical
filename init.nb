(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     77273,       2102]
NotebookOptionsPosition[     75572,       2038]
NotebookOutlinePosition[     75930,       2054]
CellTagsIndexPosition[     75887,       2051]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.549774017545526*^9, 3.549774018174136*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<Ultraspherical`\>\"", ",", "\"\<RiemannHilbert`Common`\>\""}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BandedOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReplaceEntry", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseLength", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyToRows", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LowerIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseSize", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetRowGenerator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFillValue", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Filler", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Givens", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GivensReduce", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DerivativeOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConversionOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DirichletOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549774006769565*^9, 3.5497740425113487`*^9}, {
  3.549774194301442*^9, 3.549774247624267*^9}, {3.5497743157770653`*^9, 
  3.549774324512239*^9}, {3.5497744997292747`*^9, 3.549774502961854*^9}, {
  3.549850171344842*^9, 3.54985017293055*^9}, {3.549850686637794*^9, 
  3.549850687100556*^9}, {3.549852829070692*^9, 3.549852833543066*^9}, {
  3.5498536414084997`*^9, 3.5498536672658854`*^9}, {3.550117875337818*^9, 
  3.550117882095316*^9}, {3.5501184859477167`*^9, 3.550118488394932*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BandedOperator", "Section",
 CellChangeTimes->{{3.547772351244157*^9, 3.5477723528270407`*^9}, {
  3.549773847264189*^9, 3.549773848259179*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", "___"}], 
      "]"}], ",", "i_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", ">", 
      RowBox[{"Length", "[", "fill", "]"}]}], ",", 
     RowBox[{"0", " ", 
      RowBox[{"First", "[", "fill", "]"}]}], ",", 
     RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
       RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ".", 
    RowBox[{"fls", "[", "j", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
       "opts___"}], "]"}], ",", "i_", ",", "val_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{"A", ",", "jsh", ",", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"fill", ",", 
       RowBox[{"i", "\[Rule]", "val"}]}], "]"}], ",", "rowgen", ",", "opts"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetRowGenerator", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
      "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", "___"}], 
      "]"}], "]"}], ":=", "rowgen"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   
   RowBox[{"\[Piecewise]", GridBox[{
      {
       RowBox[{
        RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", 
         RowBox[{"j", "-", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
         "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{"GetFillValue", "[", 
        RowBox[{"bnd", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{"j", ">", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "i", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"j", "-", 
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"LeftIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
        "\[LessEqual]", 
        RowBox[{"RightIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}]}]},
      {"0", "True"}
     }]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_List", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"bnd", "\[LeftDoubleBracket]", 
      RowBox[{"#", ",", "j"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
    "i"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", 
     RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", "j_Integer"}], 
    "\[RightDoubleBracket]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "im", ",", "iM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", 
      RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "im", ",", "iM"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"1", "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftIndex", "[", 
    RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"row", "+", 
      RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightIndex", "[", 
     RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LeftIndex", "[", 
      RowBox[{"bnd", ",", "row"}], "]"}], "+", 
     RowBox[{"\[Piecewise]", GridBox[{
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "row", 
           "\[RightDoubleBracket]"}], "]"}], 
         RowBox[{"row", "\[LessEqual]", 
          RowBox[{"Length", "[", "bnd", "]"}]}]},
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "row", "]"}], 
          "]"}], "True"}
       }]}], "-", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerIndex", "[", 
     RowBox[{"bnd_BandedMatrix", ",", "col_"}], "]"}], ":=", 
    RowBox[{"col", "-", 
     RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Bandwidth", "[", "bnd_BandedOperator", "]"}], ":=", 
    RowBox[{
     RowBox[{"RightBandwidth", "[", "bnd", "]"}], "-", 
     RowBox[{"LeftBandwidth", "[", "bnd", "]"}], "+", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"Length", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"Length", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "A", "]"}], ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], "+", 
       RowBox[{"Length", "[", "A", "]"}], "-", "jsh"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToArray", "[", "bnd_BandedOperator", "]"}], ":=", 
   RowBox[{"bnd", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{
       RowBox[{"Dimensions", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"MatrixForm", "[", "bnd_BandedOperator", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "===", "Null"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{
             RowBox[{"Length", "[", "bnd", "]"}], "+", "3"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IncreaseLength", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
     "A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
      "opts___"}], "]"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"A", ",", 
       RowBox[{"{", 
        RowBox[{"rowgen", "[", 
         RowBox[{
          RowBox[{"Length", "[", "A", "]"}], "+", "1"}], "]"}], "}"}]}], 
      "]"}], ",", "jsh", ",", 
     RowBox[{"Append", "[", 
      RowBox[{"fill", ",", 
       RowBox[{"0", " ", 
        RowBox[{"Last", "[", "fill", "]"}]}]}], "]"}], ",", "rowgen", ",", 
     "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzmtIk3EUBvC1SUhLAgkrolDeKKy8VBYlE3rnzG5W6nBrhenmspvbdHNT
dDBq6zLLYi3DtDbdjC10aB/KwqWUlCTlNtmSkqyotBkNhnaBtN7n/+Hwg+c8
B06SVFkgZ7NYrHRmoGFyKnlUEaa3+nw74YEvF2RQMhssh2aj42GIcWmphyjU
qr3QauogSjSiaq4yTFuO6YipOwKL1zCq8iJEu/k0x1UVpnt5l4md8j9L4MKi
sniootjbYSKVSNyr31QIbZ4UIbyWFX8E+pTZMhhTvfkkbB/IUEFpql8Lm/hf
dZBztKee9Icq9TDnkdgEl484iOISnRnq015aYE39wWa4q27lLSh8/OkO/N1r
cMLr/8QuaGhYMQolXFeE9ON+zsD8JC/XzXjRPRwHM/YVUzDTwVoL5yjrFti9
YYIok77nwSnjAgHMaWzZDQfXfd9D7oYEIqjw3i2BfZxT5dCp+KGGnuBwLdkn
nK+DcpfSCIWfG4mDsWmXID8raiX5xKJWaEy/0QEFlN8NN75444EJjskgDPHK
xqC07+04rMjs+gB7lgVm+hmrKhWzcHWFbf0zxtzOMWJ3MI9+xXhfdlsI2+wf
xTC3K/swNI1Pa2DNU38tlM3vPwvtxe5zUHPmgRk2/U1pgKUR/lUo2fbOAo1X
plsgv5Btg69pKgTnn1uI2lXfDgVgQXI+PD7wpAiOmGgRyVXRm/CXJ7YVxszd
855QM385o/3wP/74m18=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncreaseRightIndex", "[", 
     RowBox[{
      RowBox[{"bnd", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{
        "A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_", ",", 
         "opts___"}], "]"}]}], ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "bnd", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"bnd", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"RightIndex", "[", 
                RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncreaseRightIndex", "[", 
          RowBox[{
           RowBox[{"BandedOperator", "[", 
            RowBox[{"B", ",", "jsh", ",", "fil", ",", "rowgen", ",", "opts"}],
             "]"}], ",", "i", ",", "j"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReplaceEntry", "[", 
     RowBox[{
      RowBox[{"bnd", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_", ",", 
         RowBox[{"fls", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", "p_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"IncreaseSize", "\[Rule]", "False"}], "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"B", ",", "nfil"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "<", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<left of left entry\>\"", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{
            RowBox[{"bnd", "//", "IncreaseLength"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], "]"}]}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"B", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{"j", "-", 
                RowBox[{"LeftIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}], "=", "p"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"BandedOperator", "[", 
             RowBox[{"B", ",", "jsh", ",", "fil", ",", "rowgen", ",", "fls"}],
              "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
              "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{
              RowBox[{"IncreaseRightIndex", "[", 
               RowBox[{"bnd", ",", "i", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "Bn_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vals", "=", 
          RowBox[{"G", ".", 
           RowBox[{"Bn1", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "i"}], "}"}], ",", 
            RowBox[{
            "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row2", ",", "i"}], "}"}], ",", 
            RowBox[{
            "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vals", "=", 
       RowBox[{"G", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GetFill", "[", 
           RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
          RowBox[{"GetFill", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54977736426362*^9, 3.5497773976006193`*^9}, {
  3.549777515490239*^9, 3.549777578365554*^9}, {3.549777710786879*^9, 
  3.54977771509907*^9}, {3.549826484405634*^9, 3.549826488182266*^9}, {
  3.549850334482275*^9, 3.549850367896696*^9}, {3.549851079853784*^9, 
  3.549851115827414*^9}, {3.549851625284058*^9, 3.549851641474617*^9}, {
  3.549851703098495*^9, 3.549851714903438*^9}, {3.549853323781432*^9, 
  3.549853329019656*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", "jsh", ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"rowgen", "[", "#", "]"}]}], "&"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "Null", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", "jsh", ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", "Null", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", " ", 
   RowBox[{
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill1_List", ",", "rowgen1_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "+", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"B_List", ",", "jsh_", ",", "fill2_List", ",", "rowgen2_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", " ", 
    RowBox[{
     RowBox[{"A", "+", "B"}], ",", "jsh", ",", 
     RowBox[{"fill1", "+", "fill2"}], ",", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"rowgen1", "[", "#", "]"}], "+", 
       RowBox[{"rowgen2", "[", "#", "]"}]}], "&"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", " ", 
   RowBox[{
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill1_List", ",", "Null", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "+", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"B_List", ",", "jsh_", ",", "fill2_List", ",", "Null", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"A", "+", "B"}], ",", "jsh", ",", 
     RowBox[{"fill1", "+", "fill2"}], ",", "  ", "Null", ",", "opts"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549666178987925*^9, 3.5496662147884417`*^9}, {
  3.549666248709485*^9, 3.5496662603725348`*^9}, {3.549773972202506*^9, 
  3.549773973201696*^9}, {3.549822934343738*^9, 3.549822935198258*^9}, {
  3.5498594462553062`*^9, 3.5498595264925413`*^9}, {3.549861222061997*^9, 
  3.549861251218501*^9}, {3.550168895942987*^9, 3.550168907036255*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["OperatorEntry Routines", "Section",
 CellChangeTimes->{{3.549822480961389*^9, 3.549822486232541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", "Bn_BandedOperator", ",", "Bnn_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "Bn1", ",", "Bn2", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bnn"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"vals", "=", 
           RowBox[{"G", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Bn1", "\[LeftDoubleBracket]", 
               RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Bn2", "\[LeftDoubleBracket]", 
               RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "\[NotEqual]", 
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Bn1", "=", 
              RowBox[{"ReplaceEntry", "[", 
               RowBox[{"Bn1", ",", 
                RowBox[{"{", 
                 RowBox[{"row1", ",", "i"}], "}"}], ",", 
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "\[NotEqual]", 
             RowBox[{"Bn2", "\[LeftDoubleBracket]", 
              RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Bn2", "=", 
              RowBox[{"ReplaceEntry", "[", 
               RowBox[{"Bn2", ",", 
                RowBox[{"{", 
                 RowBox[{"row2", ",", "i"}], "}"}], ",", 
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"G", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Bn1", ",", "Bn2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "operator", " ", "of", " ", 
    "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "i"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"Bn1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", "B1", ",", "B2", ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", "B2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ3ZFpFTCv6JXjbLn3wSBa16nbYT6QLphs4Q6iTZ7q
+oDo5G0n/ED0HX6/ffuB9KKY52D6/Fe9EyCaX/PjBRB9iOP8VRC9TP3MdRD9
O/LcbRDdfZn9KYg23PJi+0EgbeoyeweI/nZ+/ptzQFrK1OQbiObrbzc4D6S/
8PWC6QlMJXYgWjy1yAFE5wltdwHRkw7UuoFoUTexwJDiV44K26LDQHTXzbl5
IPrD1PcFILru77FyEH3P6yyYFtV61w6i/frWdoBowcufJ4JoKbGqSSC6RbFt
GojO8UqaCaLPbdc1zwDSvq3XwLSNYuEmEJ33uxlMAwATqKil
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
List of Operator valued BandedOperators\
\>", "Section",
 CellChangeTimes->{{3.549829941925861*^9, 3.54982995406141*^9}, {
  3.549830013863139*^9, 3.5498300142594852`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{
     "G_", ",", "BDx_BandedOperator", ",", "Bd2_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "Bn2", ",", "i"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bd2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"B1", ",", "B2"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Bn2", "\[LeftDoubleBracket]", 
              RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"B1", ",", "B2"}], "}"}], "=", 
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", "B1", ",", "B2", ",", 
             RowBox[{"{", 
              RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bn1", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn1", ",", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bn2", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn2", ",", 
             RowBox[{"{", 
              RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B1", ",", "B2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GetFill", "[", 
           RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
          RowBox[{"GetFill", "[", 
           RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B1", ",", "B2"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", "B2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Bn1", ",", "Bn2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "list", " ", "operators", " ", "of", 
    " ", "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"BL", ":", 
      RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BL"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"Bn1", "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "B1", ",", "B2", ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], "=", 
       "B1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Bn1", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], "=", 
       "B2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5498299971204147`*^9, 3.549830002231*^9}, {
   3.5498300620259542`*^9, 3.549830114773*^9}, {3.549830182515881*^9, 
   3.5498303887293577`*^9}, {3.5498593176211367`*^9, 3.5498593388387737`*^9}, 
   3.55016749195546*^9, {3.5501680096337757`*^9, 3.5501680099280367`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Givens", "Section",
 CellChangeTimes->{{3.549852783991269*^9, 3.5498527850934362`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Givens", "[", 
    RowBox[{"Bin_", ",", "Binn_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a", ",", "bB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Bin", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bB", "=", 
       RowBox[{"Binn", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"a", "bB"},
          {
           RowBox[{"-", "bB"}], "a"}
         }], ")"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "bB"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "row1"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "srow1"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GivensReduce", "[", 
     RowBox[{"BDx_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"Givens", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow1", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow2", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "ssrow1"}], "]"}], 
         "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", "col_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "col"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_", ",", "scol_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", "scol_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "BDx", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"srow1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{
           "BDx", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"srow2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "scol"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549756628054965*^9, 3.549756770589405*^9}, 
   3.549822823515428*^9, {3.549826667004466*^9, 3.5498266672920227`*^9}, {
   3.5498307337308826`*^9, 3.5498308148241987`*^9}, {3.549852826370562*^9, 
   3.549852923989644*^9}, {3.549853461087563*^9, 3.5498534920722713`*^9}, {
   3.549853892662857*^9, 3.549853963029562*^9}, {3.549854300032857*^9, 
   3.549854301590097*^9}, {3.549854358701455*^9, 3.549854383645089*^9}, {
   3.550166813511777*^9, 3.5501668776717033`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives", "Section",
 CellChangeTimes->{{3.550117498093774*^9, 3.550117500418523*^9}}],

Cell[CellGroupData[{

Cell["1D", "Subsection",
 CellChangeTimes->{{3.550118929591868*^9, 3.5501189299263897`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", "1", "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"{", "#", "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", "2", "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "4", "}"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"#", "+", "1"}], ")"}]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}], ",", "0", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", "#", "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", "1", "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "1"}], "/", "2"}]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", "2", "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{
         RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
        RowBox[{"1", "/", "6"}]}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
         FractionBox["1", 
          RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
        FractionBox["1", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirichletOperator", "[", 
    RowBox[{"-", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirichletOperator", "[", "1", "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", "1", "}"}], "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", "Null", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentityOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdentityOperator", "[", "]"}], ":=", 
    RowBox[{"IdentityOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"1", ",", "\[Infinity]", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]"}], "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550117506963544*^9, 3.550117539066474*^9}, {
  3.5501176899300423`*^9, 3.550117734203289*^9}, {3.5501178225619793`*^9, 
  3.550117862768076*^9}, {3.5501180056622763`*^9, 3.5501180728070927`*^9}, {
  3.5501183917352*^9, 3.550118436148741*^9}, {3.550118468240778*^9, 
  3.550118608032094*^9}, {3.5501186666017427`*^9, 3.5501186779029503`*^9}, {
  3.5501219900588503`*^9, 3.5501219935971813`*^9}, {3.550122266376645*^9, 
  3.5501222732344313`*^9}, {3.550124503332169*^9, 3.550124504158793*^9}, {
  3.550124540936901*^9, 3.550124541080565*^9}, {3.5501245715032463`*^9, 
  3.5501245934711237`*^9}, {3.550126074402755*^9, 3.5501260936703463`*^9}, {
  3.550126142629416*^9, 3.55012618345347*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Boundary", "Subsection",
 CellChangeTimes->{{3.550118700417121*^9, 3.550118700734531*^9}, {
  3.550121793317935*^9, 3.550121794817618*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdentityOperator", "[", "]"}], ",", 
          RowBox[{"ZeroOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null", 
       ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"1", ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", "]"}], ",", 
          RowBox[{"IdentityOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null",
        ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", "1"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "}"}], ",", "1",
        ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550118636925847*^9, 3.550118657395903*^9}, {
  3.550118713262124*^9, 3.550118916277152*^9}, {3.550120334916541*^9, 
  3.5501203751819057`*^9}, {3.5501217701479483`*^9, 3.5501217780463*^9}, {
  3.550125933742004*^9, 3.550126072224814*^9}, {3.5501261883221197`*^9, 
  3.550126196219458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Derivative", "Subsection",
 CellChangeTimes->{{3.550121800768366*^9, 3.5501218029082127`*^9}, {
  3.550121980498454*^9, 3.550121981574006*^9}, {3.550122449180884*^9, 
  3.550122452090794*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"ConversionOperator", "[", "1", "]"}], "}"}], "}"}], ",", "0", 
     ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "#", ")"}], 
        RowBox[{"ConversionOperator", "[", "1", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"1", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "1", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "1", "]"}], "/", "2"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", " ", 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"#", "+", "1"}], ")"}], 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"2", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "/", "3"}], " ", 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
       "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "#"}], ")"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
            FractionBox["1", 
             RowBox[{"2", " ", "#"}]]}], ")"}], 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         FractionBox[
          RowBox[{"DerivativeOperator", "[", "2", "]"}], 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaplaceOperator", ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"4", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"#", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
              "}"}]}], "+", 
            RowBox[{"4", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
               FractionBox["1", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}]}]}], "&"}]}], 
         "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
      "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "#"}], ")"}]}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
               FractionBox["1", 
                RowBox[{"2", " ", "#"}]]}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"#", "+", "1"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"rw", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ")"}], 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"rw", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
               "}"}]}], "+", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"#", "+", "1"}], ")"}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "rw"}], ")"}]}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"rw", "+", "2"}], ")"}]}]]}], "-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", "rw"}]]}], ",", "0", ",", 
                FractionBox["1", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"rw", "+", "2"}], ")"}]}]]}], "}"}]}]}]}], "]"}]}],
          "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        FractionBox[
         RowBox[{"DerivativeOperator", "[", "2", "]"}], 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.550122452643403*^9, 3.550122480910864*^9}, {
  3.550122574777398*^9, 3.550122624935754*^9}, {3.550122657779542*^9, 
  3.550122734251135*^9}, {3.550124447345154*^9, 3.550124478636944*^9}, {
  3.5501246311602497`*^9, 3.550124676317891*^9}, {3.550124753191527*^9, 
  3.550124888158516*^9}, {3.55012495533981*^9, 3.550124957036583*^9}, {
  3.550124996059701*^9, 3.550125037266059*^9}, {3.550125085801772*^9, 
  3.550125108235787*^9}, {3.550125149534938*^9, 3.550125188195448*^9}, {
  3.550125245405364*^9, 3.550125274555833*^9}, {3.550125327605113*^9, 
  3.5501253976174927`*^9}, {3.550125431562579*^9, 3.5501254394278297`*^9}, {
  3.550125706552293*^9, 3.550125706916587*^9}, {3.550126203868326*^9, 
  3.550126249079026*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 CellChangeTimes->{{3.549774023871806*^9, 3.549774024517992*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5497740258052588`*^9, 3.54977403320975*^9}}]
}, Open  ]]
},
WindowSize->{753, 633},
WindowMargins->{{Automatic, 225}, {Automatic, 63}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 90, 1, 67, "Section"],
Cell[672, 25, 1909, 34, 343, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[2618, 64, 150, 2, 67, "Section"],
Cell[2771, 68, 12863, 349, 828, "Input",
 InitializationCell->True],
Cell[15637, 419, 8624, 206, 838, "Input",
 InitializationCell->True],
Cell[24264, 627, 2978, 71, 208, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[27279, 703, 107, 1, 67, "Section"],
Cell[27389, 706, 9223, 229, 793, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[36649, 940, 182, 4, 67, "Section"],
Cell[36834, 946, 6626, 165, 583, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[43497, 1116, 93, 1, 67, "Section"],
Cell[43593, 1119, 8480, 225, 551, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[52110, 1349, 96, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[52231, 1354, 92, 1, 34, "Subsection"],
Cell[52326, 1357, 8088, 245, 418, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[60451, 1607, 148, 2, 35, "Subsection"],
Cell[60602, 1611, 4387, 127, 193, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[65026, 1743, 201, 3, 34, "Subsection"],
Cell[65230, 1748, 9941, 272, 678, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75220, 2026, 91, 1, 67, "Section"],
Cell[75314, 2029, 242, 6, 43, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
