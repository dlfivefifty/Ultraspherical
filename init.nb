(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     37839,       1002]
NotebookOptionsPosition[     36781,        960]
NotebookOutlinePosition[     37138,        976]
CellTagsIndexPosition[     37095,        973]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.549774017545526*^9, 3.549774018174136*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<Ultraspherical`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BandedOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReplaceEntry", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightBandwidth", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseLength", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyToRows", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LowerIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseSize", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549774006769565*^9, 3.5497740425113487`*^9}, {
  3.549774194301442*^9, 3.549774247624267*^9}, {3.5497743157770653`*^9, 
  3.549774324512239*^9}, {3.5497744997292747`*^9, 3.549774502961854*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BandedOperator", "Section",
 CellChangeTimes->{{3.547772351244157*^9, 3.5477723528270407`*^9}, {
  3.549773847264189*^9, 3.549773848259179*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], 
      "]"}], ",", "i_"}], "]"}], ":=", 
   RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetFill", "[", 
     RowBox[{
      RowBox[{"BandedOperator", "[", 
       RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], 
       "]"}], ",", "i_", ",", "val_"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A", ",", "jsh", ",", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"fill", ",", 
        RowBox[{"i", "\[Rule]", "val"}]}], "]"}], ",", "rowgen"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   
   RowBox[{"\[Piecewise]", GridBox[{
      {
       RowBox[{
        RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", 
         RowBox[{"j", "-", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
         "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{"GetFill", "[", 
        RowBox[{"bnd", ",", "i"}], "]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{"j", ">", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", "bnd", "]"}], "[", "i", "]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"j", "-", 
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}], 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"LeftIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
        "\[LessEqual]", 
        RowBox[{"RightIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}]}]},
      {"0", "True"}
     }]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_List", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"bnd", "\[LeftDoubleBracket]", 
      RowBox[{"#", ",", "j"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
    "i"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", 
     RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", "j_Integer"}], 
    "\[RightDoubleBracket]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "im", ",", "iM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", 
      RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "im", ",", "iM"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"1", "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RightBandwidth", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], "-", "jsh"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftIndex", "[", 
    RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{"row", "+", 
      RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightIndex", "[", 
     RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LeftIndex", "[", 
      RowBox[{"bnd", ",", "row"}], "]"}], "+", 
     RowBox[{"\[Piecewise]", GridBox[{
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "row", 
           "\[RightDoubleBracket]"}], "]"}], 
         RowBox[{"row", "\[LessEqual]", 
          RowBox[{"Length", "[", "bnd", "]"}]}]},
        {
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"Last", "[", "bnd", "]"}], "[", "row", "]"}], "]"}], "True"}
       }]}], "-", "1"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerIndex", "[", 
     RowBox[{"bnd_BandedMatrix", ",", "col_"}], "]"}], ":=", 
    RowBox[{"col", "-", 
     RowBox[{"LeftBandwidth", "[", "bnd", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bandwidth", "[", "bnd_BandedOperator", "]"}], ":=", 
   RowBox[{
    RowBox[{"RightBandwidth", "[", "bnd", "]"}], "-", 
    RowBox[{"LeftBandwidth", "[", "bnd", "]"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetRightBandwidth", "[", 
     RowBox[{
      RowBox[{"BandedOperator", "[", 
       RowBox[{"A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_"}], 
       "]"}], ",", "m_"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"m", "+", "jsh"}], ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"PadRight", "[", 
           RowBox[{"fil", ",", 
            RowBox[{"Length", "[", "A", "]"}]}], "]"}]}], "}"}], "]"}]}], ",",
       "jsh", ",", "fil", ",", 
      RowBox[{
       RowBox[{"PadRight", "[", 
        RowBox[{
         RowBox[{"rowgen", "[", "#", "]"}], ",", 
         RowBox[{"m", "+", "jsh"}]}], "]"}], "&"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"Length", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "___"}], "]"}], "]"}], ":=", 
   RowBox[{"Length", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "jsh_", ",", "___"}], "]"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Length", "[", "A", "]"}], ",", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], "+", 
       RowBox[{"Length", "[", "A", "]"}], "-", "jsh"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToArray", "[", "bnd_BandedOperator", "]"}], ":=", 
   RowBox[{"bnd", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{
       RowBox[{"Dimensions", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}]}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"MatrixForm", "[", "bnd_BandedOperator", "]"}], ":=", 
    RowBox[{
     RowBox[{"MatrixMap", "[", 
      RowBox[{"MatrixForm", ",", 
       RowBox[{"bnd", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{";;", 
          RowBox[{
           RowBox[{"Length", "[", "bnd", "]"}], "+", "3"}]}], ",", 
         RowBox[{";;", 
          RowBox[{
           RowBox[{"RightIndex", "[", 
            RowBox[{"bnd", ",", 
             RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
        "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IncreaseLength", "[", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], "]"}],
     "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"A", ",", 
       RowBox[{"{", 
        RowBox[{"rowgen", "[", 
         RowBox[{
          RowBox[{"Length", "[", "A", "]"}], "+", "1"}], "]"}], "}"}]}], 
      "]"}], ",", "jsh", ",", 
     RowBox[{"Append", "[", 
      RowBox[{"fill", ",", 
       RowBox[{"0", " ", 
        RowBox[{"Last", "[", "fill", "]"}]}]}], "]"}], ",", "rowgen"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdy2kow3EcBvAxSUZKcqREf5H7LjRlzB3CYo0cmyVkm3PEai/mGkmMcoQM
bcXilSOLoogXhoYkJFdLlBAvxP/5vfj2qed5vj5Cab7YmsFg+NIHlU/PAacS
CyfGZEqEOQ/dIij4NFdBtUq7ekbrUmEg8loajVDTOU8UNBU1s6QWzlCZnBga
d+LgSyvLfiPOqGuZugYLZ43dT1wU/zhB28JKZyijrGOhN+VNzFREFMBpQwgP
DiY4F0OTNFkEbZojq+HsdrQMCkOPW+Bo0qMcMktWOsh+v14BU9b5ndD9SEvk
l8vVUBF2MARbO3LHYGq75zjkbdxNwe815Rwc/uProLLP4xQKWLo3snf8+oB5
PkaWnrZHf+gIo7NKKRivZfjBX0oTBZeDbogi4TUbPqusuDBlYCId7vq/ZJC/
fW4RlBgXyuEms6YKzkleG6HBfNhGeteudijWSVWQdz9A3LUL64VJCe8akt/Y
T0JV+Mg85FLHehi8d26ArtonMzxjV15A4eblFayLX7qFK24nH1u0DfWST+hV
Nx24Q5u2eEH8BzJGLZY=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncreaseRightIndex", "[", 
     RowBox[{
      RowBox[{"bnd", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_"}], 
        "]"}]}], ",", "i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "bnd", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{
            "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"bnd", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", 
              RowBox[{
               RowBox[{"RightIndex", "[", 
                RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"IncreaseRightIndex", "[", 
          RowBox[{
           RowBox[{"BandedOperator", "[", 
            RowBox[{"B", ",", "jsh", ",", "fil", ",", "rowgen"}], "]"}], ",", 
           "i", ",", "j"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReplaceEntry", "[", 
     RowBox[{
      RowBox[{"bnd", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "jsh_", ",", "fil_List", ",", "rowgen_"}], 
        "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", "p_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"IncreaseSize", "\[Rule]", "False"}], "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"B", ",", "nfil"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "<", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<left of left entry\>\"", "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{
            RowBox[{"bnd", "//", "IncreaseLength"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], "]"}]}],
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[LessEqual]", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"B", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{"j", "-", 
                RowBox[{"LeftIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}], "=", "p"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"BandedOperator", "[", 
             RowBox[{"B", ",", "jsh", ",", "fil", ",", "rowgen"}], "]"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
              "Throw", "[", "\"\<Replacing entry past size\>\"", "]"}]}], 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{
              RowBox[{"IncreaseRightIndex", "[", 
               RowBox[{"bnd", ",", "i", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "Bn_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"vals", "=", 
          RowBox[{"G", ".", 
           RowBox[{"Bn1", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "i"}], "}"}], ",", 
            RowBox[{
            "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row2", ",", "i"}], "}"}], ",", 
            RowBox[{
            "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vals", "=", 
       RowBox[{"G", ".", 
        RowBox[{"Bn1", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", 
          RowBox[{
           RowBox[{"RightIndex", "[", 
            RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", 
         RowBox[{
         "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.54977736426362*^9, 3.5497773976006193`*^9}, {
  3.549777515490239*^9, 3.549777578365554*^9}, {3.549777710786879*^9, 
  3.54977771509907*^9}, {3.549826484405634*^9, 3.549826488182266*^9}}],

Cell[BoxData[
 RowBox[{"BandedOperator", "/:", 
  RowBox[{
   RowBox[{"c_", "?", "NumberQ"}], " ", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{"A_List", ",", "jsh_", ",", "fill_List", ",", "rowgen_"}], 
    "]"}]}], ":=", 
  RowBox[{"BandedOperator", "[", 
   RowBox[{
    RowBox[{"c", " ", "A"}], ",", "jsh", ",", 
    RowBox[{"c", " ", "fill"}], ",", " ", 
    RowBox[{
     RowBox[{"c", " ", 
      RowBox[{"rowgen", "[", "#", "]"}]}], "&"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549666178987925*^9, 3.5496662147884417`*^9}, {
  3.549666248709485*^9, 3.5496662603725348`*^9}, {3.549773972202506*^9, 
  3.549773973201696*^9}, {3.549822934343738*^9, 3.549822935198258*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorEntry Routines", "Section",
 CellChangeTimes->{{3.549822480961389*^9, 3.549822486232541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", "Bn_BandedOperator", ",", "Bnn_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "Bn1", ",", "Bn2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bnn"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"vals", "=", 
           RowBox[{"G", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Bn1", "\[LeftDoubleBracket]", 
               RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Bn2", "\[LeftDoubleBracket]", 
               RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Bn1", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn1", ",", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "i"}], "}"}], ",", 
             RowBox[{
             "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bn2", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn2", ",", 
             RowBox[{"{", 
              RowBox[{"row2", ",", "i"}], "}"}], ",", 
             RowBox[{
             "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"LeftIndex", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}], ",", 
           RowBox[{"RightIndex", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"G", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Bn1", "\[LeftDoubleBracket]", 
            RowBox[{"row1", ",", 
             RowBox[{
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Bn2", "\[LeftDoubleBracket]", 
            RowBox[{"row2", ",", 
             RowBox[{
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
            "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Bn1", ",", "Bn2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "operator", " ", "of", " ", 
    "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"Bn1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "=", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", "B1", ",", "B2", ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Bn1", "=", 
          RowBox[{"ReplaceEntry", "[", 
           RowBox[{"Bn1", ",", 
            RowBox[{"{", 
             RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
            RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"LeftIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"Bn1", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"RightIndex", "[", 
           RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "B1", ",", "B2", ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", "B2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549753985825382*^9, 3.549754015472486*^9}, {
  3.549755908351828*^9, 3.5497559617679977`*^9}, {3.549756001434229*^9, 
  3.549756022272264*^9}, {3.549822450439436*^9, 3.5498224552300577`*^9}, {
  3.549822529467506*^9, 3.549822599536262*^9}, {3.549822638469819*^9, 
  3.54982265437984*^9}, {3.549822686448484*^9, 3.549822760244573*^9}, {
  3.549826495271996*^9, 3.549826500852076*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
List of Operator valued BandedOperators\
\>", "Section",
 CellChangeTimes->{{3.549829941925861*^9, 3.54982995406141*^9}, {
  3.549830013863139*^9, 3.5498300142594852`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{
     "G_", ",", "BDx_BandedOperator", ",", "Bd2_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "Bn2"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bd2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"B1", ",", "B2"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Bn2", "\[LeftDoubleBracket]", 
              RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"B1", ",", "B2"}], "}"}], "=", 
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", "B1", ",", "B2", ",", 
             RowBox[{"{", 
              RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bn1", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn1", ",", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Bn2", "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{"Bn2", ",", 
             RowBox[{"{", 
              RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
             RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"LeftIndex", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}], ",", 
           RowBox[{"RightIndex", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B1", ",", "B2"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Bn1", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Bn2", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row2"}], "]"}], "+", "1"}]}], 
           "\[RightDoubleBracket]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B1", ",", "B2"}], "}"}], "=", 
        RowBox[{"ApplyToRows", "[", 
         RowBox[{"G", ",", "B1", ",", "B2", ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", "B2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Bn1", ",", "Bn2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "list", " ", "operators", " ", "of", 
    " ", "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"BL", ":", 
      RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BL"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"Bn1", "\[LeftDoubleBracket]", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "B1", ",", "B2", ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], "=", 
       "B1"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Bn1", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], "=", 
       "B2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Bn1"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5498299971204147`*^9, 3.549830002231*^9}, {
  3.5498300620259542`*^9, 3.549830114773*^9}, {3.549830182515881*^9, 
  3.5498303887293577`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 CellChangeTimes->{{3.549774023871806*^9, 3.549774024517992*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5497740258052588`*^9, 3.54977403320975*^9}}]
}, Open  ]]
},
WindowSize->{873, 734},
WindowMargins->{{157, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 90, 1, 67, "Section"],
Cell[672, 25, 1004, 19, 193, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1713, 49, 150, 2, 67, "Section"],
Cell[1866, 53, 11488, 313, 693, "Input",
 InitializationCell->True],
Cell[13357, 368, 8308, 202, 808, "Input",
 InitializationCell->True],
Cell[21668, 572, 711, 17, 43, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[22416, 594, 107, 1, 37, "Section"],
Cell[22526, 597, 7538, 183, 628, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[30101, 785, 182, 4, 67, "Section"],
Cell[30286, 791, 6106, 152, 583, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[36429, 948, 91, 1, 67, "Section"],
Cell[36523, 951, 242, 6, 43, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
