(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    128183,       3400]
NotebookOptionsPosition[    125991,       3321]
NotebookOutlinePosition[    126346,       3337]
CellTagsIndexPosition[    126303,       3334]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.549774017545526*^9, 3.549774018174136*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<Ultraspherical`\>\"", ",", "\"\<RiemannHilbert`Common`\>\""}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BandedOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ReplaceEntry", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseLength", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyToRows", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LowerIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LeftIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightIndex", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IncreaseSize", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetFill", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetRowGenerator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetFillValue", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Filler", ";"}], "\[IndentingNewLine]", 
 RowBox[{"Givens", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GivensReduce", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DerivativeOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConversionOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"DirichletOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"IdentityOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ZeroOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"LaplaceOperator", ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListRowReduce", ";"}], "\[IndentingNewLine]", 
 RowBox[{"RightHandSide", ";"}], "\[IndentingNewLine]", 
 RowBox[{"GetRow", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549774006769565*^9, 3.5497740425113487`*^9}, {
  3.549774194301442*^9, 3.549774247624267*^9}, {3.5497743157770653`*^9, 
  3.549774324512239*^9}, {3.5497744997292747`*^9, 3.549774502961854*^9}, {
  3.549850171344842*^9, 3.54985017293055*^9}, {3.549850686637794*^9, 
  3.549850687100556*^9}, {3.549852829070692*^9, 3.549852833543066*^9}, {
  3.5498536414084997`*^9, 3.5498536672658854`*^9}, {3.550117875337818*^9, 
  3.550117882095316*^9}, {3.5501184859477167`*^9, 3.550118488394932*^9}, {
  3.550176224408351*^9, 3.550176228807666*^9}, {3.550178654735545*^9, 
  3.550178663063488*^9}, {3.550258672098682*^9, 3.5502586742161093`*^9}, {
  3.5503455450812597`*^9, 3.550345547671606*^9}, {3.550464823161845*^9, 
  3.550464823552328*^9}, {3.550700755349419*^9, 3.550700755893032*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["BandedOperator", "Section",
 CellChangeTimes->{{3.547772351244157*^9, 3.5477723528270407`*^9}, {
  3.549773847264189*^9, 3.549773848259179*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", "___"}], "]"}],
      ",", "i_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"i", ">", 
      RowBox[{"Length", "[", "fill", "]"}]}], ",", 
     RowBox[{"0", " ", 
      RowBox[{"First", "[", "fill", "]"}]}], ",", 
     RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetFillValue", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", 
       RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"fill", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
    ".", 
    RowBox[{"fls", "[", "j", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetFill", "[", 
    RowBox[{
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", "opts___"}], 
      "]"}], ",", "i_", ",", "val_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{"A", ",", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{"fill", ",", 
       RowBox[{"i", "\[Rule]", "val"}]}], "]"}], ",", "rowgen", ",", "opts"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetRowGenerator", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", "___"}], "]"}],
      "]"}], ":=", "rowgen"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetRow", "[", 
     RowBox[{
      RowBox[{"BandedOperator", "[", 
       RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", "___"}], 
       "]"}], ",", "i_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", ">", 
       RowBox[{"Length", "[", "A", "]"}]}], ",", 
      RowBox[{"rowgen", "[", "i", "]"}], ",", 
      RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   
   RowBox[{"\[Piecewise]", GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "j", 
        "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{
         RowBox[{"LeftIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
         "\[LessEqual]", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{"GetFillValue", "[", 
        RowBox[{"bnd", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}]}], "]"}], 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "bnd", "]"}]}], "&&", 
        RowBox[{"j", ">", 
         RowBox[{"RightIndex", "[", 
          RowBox[{"bnd", ",", "i"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "i", "]"}], 
        "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
       RowBox[{
        RowBox[{"LeftIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}], "\[LessEqual]", "j", 
        "\[LessEqual]", 
        RowBox[{"RightIndex", "[", 
         RowBox[{"bnd", ",", "i"}], "]"}]}]},
      {"0", "True"}
     }]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"bnd_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_List", ",", "j_Integer"}], "\[RightDoubleBracket]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"bnd", "\[LeftDoubleBracket]", 
      RowBox[{"#", ",", "j"}], "\[RightDoubleBracket]"}], "&"}], "/@", 
    "i"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{"i_Integer", ",", 
     RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", "j_Integer"}], 
    "\[RightDoubleBracket]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sp", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "im", ",", "iM"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"sp_BandedOperator", "\[LeftDoubleBracket]", 
     RowBox[{
      RowBox[{"im_Integer", ";;", "iM_Integer"}], ",", 
      RowBox[{"jm_Integer", ";;", "jM_Integer"}]}], "\[RightDoubleBracket]"}],
     ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sp", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "im", ",", "iM"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "jm", ",", "jM"}], "}"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LeftIndex", "[", 
    RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GetRow", "[", 
       RowBox[{"bnd", ",", "row"}], "]"}], "//", "FirstIndex"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RightIndex", "[", 
     RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"GetRow", "[", 
      RowBox[{"bnd", ",", "row"}], "]"}], "//", "LastIndex"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LowerIndex", "[", 
     RowBox[{"bnd_BandedMatrix", ",", "col_"}], "]"}], ":=", 
    RowBox[{"Throw", "[", "\"\<not implemented\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"Length", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "___"}], "]"}], "]"}], ":=", 
    RowBox[{"Length", "[", "A", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToArray", "[", "bnd_BandedOperator", "]"}], ":=", 
   RowBox[{"bnd", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{";;", 
      RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
     RowBox[{";;", 
      RowBox[{"RightIndex", "[", 
       RowBox[{"bnd", ",", 
        RowBox[{"Length", "[", "bnd", "]"}]}], "]"}]}]}], 
    "\[RightDoubleBracket]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", 
    RowBox[{"MatrixForm", "[", "bnd_BandedOperator", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "===", "Null"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{"Length", "[", "bnd", "]"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatrixMap", "[", 
        RowBox[{"MatrixForm", ",", 
         RowBox[{"bnd", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{";;", 
            RowBox[{
             RowBox[{"Length", "[", "bnd", "]"}], "+", "3"}]}], ",", 
           RowBox[{";;", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"bnd", ",", 
               RowBox[{"Length", "[", "bnd", "]"}]}], "]"}], "+", "3"}]}]}], 
          "\[RightDoubleBracket]"}]}], "]"}], "//", "MatrixForm"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IncreaseLength", "[", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", "opts___"}], 
      "]"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"A", ",", 
        RowBox[{"{", 
         RowBox[{"rowgen", "[", 
          RowBox[{
           RowBox[{"Length", "[", "A", "]"}], "+", "1"}], "]"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"fill", ",", 
        RowBox[{"0", " ", 
         RowBox[{"Last", "[", "fill", "]"}]}]}], "]"}], ",", "rowgen", ",", 
      "opts"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "Length", " ", "to", " ", "be", " ", "at", " ", 
    "least", " ", "n"}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IncreaseLength", "[", 
    RowBox[{"bnd_BandedOperator", ",", "n_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "bnd", "]"}], "\[GreaterEqual]", "n"}], ",", 
     "bnd", ",", 
     RowBox[{"IncreaseLength", "[", 
      RowBox[{
       RowBox[{"bnd", "//", "IncreaseLength"}], ",", "n"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzmtIk3EUBvClFtK0QMKKKJQ3Ei0vmYWtGb1Ts5uVOnStMN1cVtNt6ryl
A7GtyyyLuZRS05rGZrq0D6nhUkpMFO/MpEQrKnWGgmg6SOt9/h8OP3jOc+B4
iuTREgcWixXMDCyYmvYekdnog4ODx+DZn7fFULhkTYZataF5lHFLopnIz8qw
QL2mlihUxmWy5TZadzmb6Hd42GU3oyJynlitlToa0210C/cesV5i3ww3xCa5
QQXlEAw9KA/iKdX+GFhl9uXDhyFuF+GgPFQMnTIDr8HnHUEKKPIbyoKlvF/Z
0PFSUz7pd6epYHirQAO3DRiIgoRsLVT59+hgTv65x/B43o4nkP/2+1O40lJQ
A0v+CYywoGj7CBSyjfOk7/pnEUZ5WtgmxjumXlcYdDqeghwDaw9cpfQHYOPe
SaJYNMGF0+p1YTC8uPwE7PT6fZLcdYfFQZnlRQJsc7yeDGtkcxnQbO3NJXv3
W3lQYpSrIf9HMbHT2f8u5IUs6Ek+ubECqgMe1cIwasgE9338ZIbuhikrHOUm
jUFR2+dxmMpp+Aqbtg4vtjOmp8mW4K7UKp8PjBH1Y8RGayTdx/haXMmHz6q/
CWBEQ+gFqBmfVcKc90O5ULx2phBWx5tuQmXKGy0s/etbBBPneQ+g8NAXHVTf
ny2HvBiHKthPU6NwrUtHzNo5c34YRntHwSsd72LhgIaOI7lioQwum50roNNq
neVqBvNXzUI75AT0zEgZY93Ec/BVafwyXGldXIHr7XUvUxh95tj1kNNH8e2M
XMl4Mgw/0iyFnf0uuSQvu6GCbQHRhXCT3dAlVdrowI4JoqhLeTSFccyrkvgf
cBPg4Q==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Set", " ", "Row", " ", "Length", " ", "at", " ", "i", " ", "to",
     " ", "be", " ", "at", " ", "least", " ", "j"}], " ", "**)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseRightIndex", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{"A_List", ",", "fil_List", ",", "rowgen_", ",", "opts___"}], 
         "]"}]}], ",", "i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
         "bnd", "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"bnd", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"RightIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IncreaseRightIndex", "[", 
           RowBox[{
            RowBox[{"BandedOperator", "[", 
             RowBox[{"B", ",", "fil", ",", "rowgen", ",", "opts"}], "]"}], 
            ",", "i", ",", "j"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseRowIndexRange", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{"A_List", ",", "fil_List", ",", "rowgen_", ",", "opts___"}], 
         "]"}]}], ",", "i_", ",", 
       RowBox[{"{", 
        RowBox[{"li_", ",", "lr_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "B", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"lr", "\[LessEqual]", 
          RowBox[{"LastIndex", "[", 
           RowBox[{
           "A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"IncreaseIndexRange", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"li", ",", "lr"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BandedOperator", "[", 
           RowBox[{"B", ",", "fil", ",", "rowgen", ",", "opts"}], "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"bnd", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"RightIndex", "[", 
                 RowBox[{"bnd", ",", "i"}], "]"}], "+", "1"}]}], 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IncreaseRowIndexRange", "[", 
           RowBox[{
            RowBox[{"BandedOperator", "[", 
             RowBox[{"B", ",", "fil", ",", "rowgen", ",", "opts"}], "]"}], 
            ",", "i", ",", 
            RowBox[{"{", 
             RowBox[{"li", ",", "lr"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RowLength", "[", 
      RowBox[{
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "fil_List", ",", "rowgen_", ",", "opts___"}], 
        "]"}], ",", "i_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "//",
       "Length"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IncreaseDimension", "[", 
      RowBox[{"bnd_BandedOperator", ",", "bnd2_BandedOperator"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "Bn"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn", "=", 
         RowBox[{"IncreaseLength", "[", 
          RowBox[{"bnd", ",", 
           RowBox[{"Length", "[", "bnd2", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Bn", "=", 
            RowBox[{"IncreaseRowIndexRange", "[", 
             RowBox[{"Bn", ",", "i", ",", 
              RowBox[{
               RowBox[{"GetRow", "[", 
                RowBox[{"bnd2", ",", "i"}], "]"}], "//", "IndexRange"}]}], 
             "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "bnd2", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "Bn"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceEntry", "[", 
      RowBox[{
       RowBox[{"bnd", ":", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{"A_List", ",", "fil_List", ",", "rowgen_", ",", 
          RowBox[{"fls", ":", 
           RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", "p_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", 
         RowBox[{"IncreaseSize", "\[Rule]", "False"}], "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B", ",", "nfil"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "~", "NEqual", "~", 
           RowBox[{"bnd", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ")"}], ",", 
         "\[IndentingNewLine]", "bnd", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", ">", 
           RowBox[{"Length", "[", "A", "]"}]}], "&&", 
          RowBox[{"!", 
           RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Replacing entry past size\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"i", ">", 
          RowBox[{"Length", "[", "A", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ReplaceEntry", "[", 
          RowBox[{
           RowBox[{"bnd", "//", "IncreaseLength"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"NZeroQ", "[", "p", "]"}], "&&", 
            RowBox[{"j", "\[Equal]", 
             RowBox[{"LeftIndex", "[", 
              RowBox[{"bnd", ",", "i"}], "]"}]}]}], ")"}], "&&", 
          RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"*", " ", "Shorten", " ", "list"}], " ", "**)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",",
              "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"BandedOperator", "[", 
           RowBox[{"B", ",", "fil", ",", "rowgen", ",", "fls"}], "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"RightIndex", "[", 
           RowBox[{"bnd", ",", "i"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"B", "=", "A"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
           RowBox[{"ReplaceEntry", "[", 
            RowBox[{
             RowBox[{
             "B", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",",
              "j", ",", "p", ",", "opts"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"BandedOperator", "[", 
           RowBox[{"B", ",", "fil", ",", "rowgen", ",", "fls"}], "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"OptionValue", "[", "IncreaseSize", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Throw", "[", "\"\<Replacing entry past size\>\"", "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "True", " ", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"ReplaceEntry", "[", 
          RowBox[{
           RowBox[{"IncreaseRightIndex", "[", 
            RowBox[{"bnd", ",", "i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], ",", "p", ",", "opts"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", "Bn_BandedOperator", ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "Bn1", ",", "rhs"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"vals", "=", 
            RowBox[{"Bn1", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"vals", "=", 
            RowBox[{"G", ".", "vals"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Bn1", "=", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{"Bn1", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "i"}], "}"}], ",", 
              RowBox[{
              "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Bn1", "=", 
            RowBox[{"ReplaceEntry", "[", 
             RowBox[{"Bn1", ",", 
              RowBox[{"{", 
               RowBox[{"row2", ",", "i"}], "}"}], ",", 
              RowBox[{
              "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
           ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}]}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row2"}], "]"}], ",", 
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"vals", "=", 
         RowBox[{"G", ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"GetFill", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"GetFill", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row1", ",", 
           RowBox[{
           "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row2", ",", 
           RowBox[{
           "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", "Bn1", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Bn1", ",", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], ",", 
              RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzF1IU3EABfBN5yXvZlk45pLEYtNUsg8RXMloLEpUCgZhoBZ+DMKPLcqG
u+hatIEPjnBjEGmx2RB1IG5CSWRiFL1spqm0RBwSDVnSQxusbbfl/9yHw4/z
cM7JDr1Gm8Xj8eQk0KEffjt9P6q6Wjv/HtJz+iB86W/chCeqvv+EzsrOCIyn
Rl4vE0s2c97AgO5LS5D4zsfegdWa9AI8wzCLkC8p/wfzz539D8OlP6gVYmKv
9RA08Y1rkHKXfIU6dSDZ8yCq2vHq07D10aKhl5gOyI3w+NjWELzO5Jog22V9
Civ+XBiFpWV+J7Q30xOwQW0X9BGzxp9xskbVZzgpdXDSr36Jl4hMfUwKBcrL
crhjuVHDKWAGochTbIGhSu3DAH7FicewrU34Ika8p7a7ILM87oH7p2yTkC1a
yUDtRxsVJzad1h2Gt8sLjsDQc+tUkthdY/bCqHvNB2Up2QfY0aMU9vZHVRcj
6qMwn3KxsNDSSPcRDRuZa3AiPF8Pr0zFbkJzWNQM79b9bed6g6Ifsqt5JhhS
rD+Bv8/H5uCsq3sBHttrWoKSS7c+Qe3uzDb0jMXDMJjdTumw81s4U1JaCL9t
D4jgAbW8ON0=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "fill_List", ",", "rowgen_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"rowgen", "[", "#", "]"}]}], "&"}], ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"c_", "?", "NumberQ"}], " ", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{"A_List", ",", "fill_List", ",", "Null", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"c", " ", "A"}], ",", 
     RowBox[{"c", " ", "fill"}], ",", " ", "Null", ",", "opts"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BandedOperator", "/:", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"bndA", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"A_List", ",", "fill1_List", ",", "Null", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"bndB", ":", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{"B_List", ",", "fill2_List", ",", "Null", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bnA", ",", "bnB"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bnA", "=", 
        RowBox[{"IncreaseDimension", "[", 
         RowBox[{"bndA", ",", "bndB"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bnB", "=", 
        RowBox[{"IncreaseDimension", "[", 
         RowBox[{"bndB", ",", "bnA"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"BandedOperator", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "[", "bnA", "]"}], "+", 
          RowBox[{"First", "[", "bnB", "]"}]}], ",", 
         RowBox[{
          RowBox[{
          "bnA", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
          
          RowBox[{
          "bnB", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         ",", "  ", "Null", ",", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{
    RowBox[{"(", " ", 
     RowBox[{"bndA", ":", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{"A_List", ",", "fill1_List", ",", 
        RowBox[{"rowgen1_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"#", "===", "Null"}], ")"}]}], "&"}], ")"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{"bndB", ":", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{"B_List", ",", "fill2_List", ",", "rowgen2_", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bnA", ",", "bnB", ",", "rowlength"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bnA", "=", 
       RowBox[{"IncreaseDimension", "[", 
        RowBox[{"bndA", ",", "bndB"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bnB", "=", 
       RowBox[{"IncreaseDimension", "[", 
        RowBox[{"bndB", ",", "bnA"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"BandedOperator", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", "bnA", "]"}], "+", 
         RowBox[{"First", "[", "bnB", "]"}]}], ",", 
        RowBox[{
         RowBox[{
         "bnA", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
         RowBox[{
         "bnB", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",",
         " ", 
        RowBox[{
         RowBox[{
          RowBox[{"IncreaseIndexRange", "[", " ", 
           RowBox[{
            RowBox[{"rowgen1", "[", "#", "]"}], ",", 
            RowBox[{
             RowBox[{"rowgen2", "[", "#", "]"}], "//", "IndexRange"}]}], 
           "]"}], "+", 
          RowBox[{"IncreaseIndexRange", "[", 
           RowBox[{
            RowBox[{"rowgen2", "[", "#", "]"}], ",", 
            RowBox[{
             RowBox[{"rowgen1", "[", "#", "]"}], "//", "IndexRange"}]}], 
           "]"}]}], "&"}], ",", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQLTo3vqC46JXjK6ubJSBaaotYJYg+97q7CkS/q2oT
WgGkvUuWgenn/0/92g+kFSOegekK7RPnLgLpZ4fO3wDRD38fXHMJSH/7m7YB
RH/W+fc8o/iVI4Nm4ksQ/edpWUYukN5xur8eRPs9dGsF0TFtlu0g+uxpiwcg
+vGsYy9AtJhhiGAekM7aswlMT+rPEwfRMQJCMiA6TjHOCUTL7tJzBtE8spcD
QPSMs9sTQPTunm9/PgPpiUHr/4LoA14J3F+AdIPbWR4QfcTPXTKn5JVjzvoH
CiD6iWjtKhBdtmQnmDYS8BXJBdKGf8olQTQAonWjPg==
  "]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.55018008189603*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.550180005369152*^9, 3.550180005975665*^9}, {
  3.550180084808528*^9, 3.5501800888800507`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["List ApplyTORows", "Section",
 CellChangeTimes->{{3.550372883456237*^9, 3.550372887486576*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_Integer", ",", "row2_Integer"}], "}"}], ",", 
      "rhsin_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rhs", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhs", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row1", ",", "row2", ",", 
            RowBox[{"Length", "[", "rhsin", "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rhs", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"G", ".", 
         RowBox[{"rhs", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       "rhs"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_Integer", ",", "row2_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_Integer", ",", "srow2_Integer"}], "}"}], ",", 
      "rhsin_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhs", ",", "rhs1", ",", "rhs2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhs", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row1", ",", "row2", ",", 
            RowBox[{"Length", "[", "rhsin", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"row1", "\[Equal]", "row2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", 
             RowBox[{"{", 
              RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
             RowBox[{
             "rhs", "\[LeftDoubleBracket]", "row1", 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{
             "rhs", "\[LeftDoubleBracket]", "row2", 
              "\[RightDoubleBracket]"}]}], "}"}], "=", 
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", 
             RowBox[{"{", 
              RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
             RowBox[{
             "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}],
              ",", 
             RowBox[{
             "rhs", "\[LeftDoubleBracket]", "row2", 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "rhs"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_Integer", ",", "row2_Integer"}], "}"}], ",", 
      "rhsin1_List", ",", "rhsin2_List"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhs1", ",", "rhs2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhs1", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row1", ",", 
            RowBox[{"Length", "[", "rhsin1", "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rhs2", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin2", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row2", ",", 
            RowBox[{"Length", "[", "rhsin2", "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "rhs2", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}]}],
          "}"}], "=", 
        RowBox[{"G", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "rhs2", "\[LeftDoubleBracket]", "row2", 
            "\[RightDoubleBracket]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rhs1", ",", "rhs2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_Integer", ",", "row2_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_Integer", ",", "srow2_Integer"}], "}"}], ",", "rhsin1_",
       ",", "rhsin2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhs1", ",", "rhs2", ",", "srhs1", ",", "srhs2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhs1", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin1", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row1", ",", 
            RowBox[{"Length", "[", "rhsin1", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rhs2", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{"rhsin2", ",", 
          RowBox[{"Max", "[", 
           RowBox[{"row2", ",", 
            RowBox[{"Length", "[", "rhsin2", "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "rhs2", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}]}],
          "}"}], "=", 
        RowBox[{"ApplyToRows", "[", 
         RowBox[{"G", ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
          RowBox[{
          "rhs1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "rhs2", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rhs1", ",", "rhs2"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_Integer", ",", "row2_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_Integer", ",", "srow2_Integer"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_Integer", ",", "ssrow2_Integer"}], "}"}], ",", 
     "rhsin_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rhs", ",", "rhs1", ",", "rhs2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rhs", "=", "rhsin"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"row1", "\[Equal]", "row2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", 
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row1", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row2", 
             "\[RightDoubleBracket]"}]}], "}"}], "=", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", 
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "rhs", "\[LeftDoubleBracket]", "row2", 
             "\[RightDoubleBracket]"}]}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "rhs"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5503728978966312`*^9, 3.550372965420223*^9}, {
  3.550373024949353*^9, 3.550373077106784*^9}, {3.5503731278437557`*^9, 
  3.550373188959558*^9}, {3.5503732425720654`*^9, 3.550373268435628*^9}, {
  3.5503733371725082`*^9, 3.550373430341997*^9}, {3.550373472608707*^9, 
  3.550373678194118*^9}, {3.5503744831240788`*^9, 3.550374530634441*^9}, {
  3.550443704649563*^9, 3.550443707335807*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorEntry Routines", "Section",
 CellChangeTimes->{{3.549822480961389*^9, 3.549822486232541*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowZeroQ", "[", 
    RowBox[{"0", ",", "_"}], "]"}], ":=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RowZeroQ", "[", 
    RowBox[{"bnd_BandedOperator", ",", "row_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"row", "\[LessEqual]", 
          RowBox[{"Length", "[", "bnd", "]"}]}], ",", "\[IndentingNewLine]", 
         "\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", "bnd", "]"}], "\[LeftDoubleBracket]", "row",
             "\[RightDoubleBracket]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"bnd", ",", "row"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "[", "row", "]"}], 
          "}"}]}], "]"}], "//", "Flatten"}], "//", "Abs"}], "//", "Total"}], "//",
     "NZeroQ"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RowZeroQ", "[", 
    RowBox[{"_", ",", "_"}], "]"}], ":=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NZeroQ", "[", "bnd_BandedOperator", "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GetRowGenerator", "[", "bnd", "]"}], "===", "Null"}], ")"}], "&&", 
     RowBox[{"NZeroQ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"First", "[", "bnd", "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"bnd", ",", "1"}], "]"}]}], "}"}], "//", "Flatten"}], "//",
         "Abs"}], "//", "Total"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToRows", "[", 
     RowBox[{"G_", ",", "Bn_BandedOperator", ",", "Bnn_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vals", ",", "Bn1", ",", "Bn2", ",", "i", ",", "rhs1", ",", "rhs2"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bn1", "=", "Bn"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", "Bnn"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"NZeroQ", "[", 
                RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                 RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], "]"}],
                "&&", 
               RowBox[{"NZeroQ", "[", 
                RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                 RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}], 
                "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"vals", "=", 
              RowBox[{"G", ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                  RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
                 
                 RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                  RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
                "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"Bn1", "\[LeftDoubleBracket]", 
                 RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Bn1", "=", 
                 RowBox[{"ReplaceEntry", "[", 
                  RowBox[{"Bn1", ",", 
                   RowBox[{"{", 
                    RowBox[{"row1", ",", "i"}], "}"}], ",", 
                   RowBox[{
                   "vals", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "vals", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"Bn2", "\[LeftDoubleBracket]", 
                 RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Bn2", "=", 
                 RowBox[{"ReplaceEntry", "[", 
                  RowBox[{"Bn2", ",", 
                   RowBox[{"{", 
                    RowBox[{"row2", ",", "i"}], "}"}], ",", 
                   RowBox[{
                   "vals", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"LeftIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
             RowBox[{"RightIndex", "[", 
              RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"vals", "=", 
        RowBox[{"G", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Bn1", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn1", ",", "row1", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Bn2", "=", 
        RowBox[{"SetFill", "[", 
         RowBox[{"Bn2", ",", "row2", ",", 
          RowBox[{
          "vals", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", "Null"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", 
           RowBox[{"ApplyToRows", "[", 
            RowBox[{"G", ",", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], ",", 
             RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "is", " ", "for", " ", "operator", " ", "of", " ", 
    "operators"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NullOperatorQ", "[", 
     RowBox[{"G_", ",", "B1_", ",", "B2_", ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowZeroQ", "[", 
           RowBox[{"B1", ",", "srow1"}], "]"}], "||", 
          RowBox[{"NZeroQ", "[", "B1", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RowZeroQ", "[", 
           RowBox[{"B2", ",", "srow2"}], "]"}], "||", 
          RowBox[{"NZeroQ", "[", "B2", "]"}]}], ")"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NZeroQ", "[", 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"G", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "~", "NEqual", 
          "~", "1"}], ")"}], "&&", 
        RowBox[{"RowZeroQ", "[", 
         RowBox[{"B1", ",", "srow1"}], "]"}]}], ")"}]}], ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToRows", "[", 
    RowBox[{"G_", ",", "BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "i", ",", "rhs", ",", 
       "rhs1", ",", "rhs2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"row1", "\[Equal]", "row2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"B1", "=", 
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NullOperatorQ", "[", 
                RowBox[{"G", ",", "B1", ",", "B1", ",", 
                 RowBox[{"{", 
                  RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"B1", "=", 
                RowBox[{"ApplyToRows", "[", 
                 RowBox[{"G", ",", "B1", ",", 
                  RowBox[{"{", 
                   RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Bn1", "=", 
                RowBox[{"ReplaceEntry", "[", 
                 RowBox[{"Bn1", ",", 
                  RowBox[{"{", 
                   RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
                  RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"B1", ",", "B2"}], "}"}], "=", 
             RowBox[{"Bn1", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"row1", ",", "row2"}], "}"}], ",", "i"}], 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"NullOperatorQ", "[", 
                RowBox[{"G", ",", "B1", ",", "B2", ",", 
                 RowBox[{"{", 
                  RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"B1", ",", "B2"}], "}"}], "=", 
                RowBox[{"ApplyToRows", "[", 
                 RowBox[{"G", ",", "B1", ",", "B2", ",", 
                  RowBox[{"{", 
                   RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Bn1", "=", 
                RowBox[{"ReplaceEntry", "[", 
                 RowBox[{"Bn1", ",", 
                  RowBox[{"{", 
                   RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
                  RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"Bn1", "=", 
                RowBox[{"ReplaceEntry", "[", 
                 RowBox[{"Bn1", ",", 
                  RowBox[{"{", 
                   RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
                  RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"LeftIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}], ",", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
            RowBox[{"RightIndex", "[", 
             RowBox[{"Bn1", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
         RowBox[{"GetFill", "[", 
          RowBox[{"Bn1", ",", "row2"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B1", ",", "B2"}], "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Bn1", "=", 
       RowBox[{"SetFill", "[", 
        RowBox[{"Bn1", ",", "row2", ",", "B2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", "Null"}], 
        ",", "\[IndentingNewLine]", "Bn1", ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Bn1", ",", 
          RowBox[{"ApplyToRows", "[", 
           RowBox[{"G", ",", 
            RowBox[{"{", 
             RowBox[{"row1", ",", "row2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
            RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdxVsoQ3EAB+BZilETtdFyGw8uNZeaSBImJNZcElFq6whpxsgSStiW466J
5hYlD0hi8yBsStKxqblGyoNIYnJ5IOX/Ow9fn1jZWExxORxOJIGNdamK2ebn
THPoWwmWZNEZc2TNeEoulj5ICrDKciTHt37y3T3yQtUju/Mr7gj7xbyfYru3
8xwvRTGX+LfCcYNpl9cDTtx8strISdnmbfztnHtxkEVJ0m/MHzYkOMmf/EH2
EW5LOg6kmjOwOsCajcf2O3OwIEdYVKp9zgy3VJbh/usZNXab3jS46++wDd/l
n7ALYl8NWD60asT+ro9RLBK2j+FesX4CN+Qrp7DDKkmuJRf2XbCniZs2sPq3
h30xThekIReHCMKw/t3tpSV3bMR7Y+762soeeVbmY8NKxnXMbqIvcbx93/OA
zKt287C+lfHHukaOEHv80CG45s4YjUVT1waGvK066MeKdt00jlB0z2MptUW/
kutNviZ85royYxm1M40H+JMWvJlXvoN5902HuCuaYnDujMyNuWv37MGCZfqD
HGrTDuB/vPspeg==
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
List of Operator valued BandedOperators\
\>", "Section",
 CellChangeTimes->{{3.549829941925861*^9, 3.54982995406141*^9}, {
  3.549830013863139*^9, 3.5498300142594852`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.55044292965053*^9, 3.550442930312819*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.550442906256974*^9, 3.5504429198333817`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", "BDx_BandedOperator", ",", "Bd2_BandedOperator", ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "Bn2", ",", "i", ",", 
         "rhs1", ",", "rhs2", ",", "srhs1", ",", "srhs2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "BDx"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bn2", "=", "Bd2"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Bn1", "\[LeftDoubleBracket]", 
               RowBox[{"row1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"Bn2", "\[LeftDoubleBracket]", 
               RowBox[{"row2", ",", "i"}], "\[RightDoubleBracket]"}]}], 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"NullOperatorQ", "[", 
               RowBox[{"G", ",", "B1", ",", "B2", ",", 
                RowBox[{"{", 
                 RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"B1", ",", "B2"}], "}"}], "=", 
               RowBox[{"ApplyToRows", "[", 
                RowBox[{"G", ",", "B1", ",", "B2", ",", 
                 RowBox[{"{", 
                  RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Bn1", "=", 
               RowBox[{"ReplaceEntry", "[", 
                RowBox[{"Bn1", ",", 
                 RowBox[{"{", 
                  RowBox[{"row1", ",", "i"}], "}"}], ",", "B1", ",", 
                 RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Bn2", "=", 
               RowBox[{"ReplaceEntry", "[", 
                RowBox[{"Bn2", ",", 
                 RowBox[{"{", 
                  RowBox[{"row2", ",", "i"}], "}"}], ",", "B2", ",", 
                 RowBox[{"IncreaseSize", "\[Rule]", "True"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
              RowBox[{"LeftIndex", "[", 
               RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}], ",", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
              RowBox[{"RightIndex", "[", 
               RowBox[{"Bn2", ",", "row2"}], "]"}]}], "]"}]}], "}"}]}], "]"}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B1", ",", "B2"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn1", ",", "row1"}], "]"}], ",", 
           RowBox[{"GetFill", "[", 
            RowBox[{"Bn2", ",", "row2"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B1", ",", "B2"}], "}"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "]"}]}], "//", "Thread"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Bn1", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn1", ",", "row1", ",", "B1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Bn2", "=", 
         RowBox[{"SetFill", "[", 
          RowBox[{"Bn2", ",", "row2", ",", "B2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Bn1", ",", "Bn2"}], "}"}], ",", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "for", " ", "list", " ", "operators", " ", "of", 
     " ", "operators"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", 
       RowBox[{"BL", ":", 
        RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "rhs"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "BL"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"row1", "===", "row2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{
              "Bn1", "\[LeftDoubleBracket]", "row1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"Bn1", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", "B1", ",", "B2", ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", "B1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "=", "B2"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", "Bn1", "\[IndentingNewLine]",
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Bn1", ",", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToRows", "[", 
      RowBox[{"G_", ",", 
       RowBox[{"BL", ":", 
        RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "Bn1", ",", "B1", ",", "B2", ",", "rhs"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Bn1", "=", "BL"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"row1", "===", "row2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{
              "Bn1", "\[LeftDoubleBracket]", "row1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"Bn1", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"row1", ",", "row2"}], "}"}], 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"B1", ",", "B2"}], "}"}], "=", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", "B1", ",", "B2", ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ssrow1", ",", "ssrow2"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "=", "B1"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Bn1", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "=", "B2"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "RightHandSide", "]"}], "===", 
           "Null"}], ",", "\[IndentingNewLine]", "Bn1", "\[IndentingNewLine]",
           ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"Bn1", ",", 
            RowBox[{"ApplyToRows", "[", 
             RowBox[{"G", ",", 
              RowBox[{"{", 
               RowBox[{"row1", ",", "row2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", 
              RowBox[{"OptionValue", "[", "RightHandSide", "]"}]}], "]"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5498299971204147`*^9, 3.549830002231*^9}, {
   3.5498300620259542`*^9, 3.549830114773*^9}, {3.549830182515881*^9, 
   3.5498303887293577`*^9}, {3.5498593176211367`*^9, 3.5498593388387737`*^9}, 
   3.55016749195546*^9, {3.5501680096337757`*^9, 3.5501680099280367`*^9}, {
   3.5501826001531*^9, 3.550182637688943*^9}, 3.550183615697843*^9, {
   3.550187827217231*^9, 3.550187830368005*^9}, {3.550187881913268*^9, 
   3.550187894167808*^9}, {3.550346973346636*^9, 3.5503470529798937`*^9}, {
   3.550347109859839*^9, 3.550347117881908*^9}, {3.5503474551916437`*^9, 
   3.550347565820326*^9}, {3.550347703926031*^9, 3.550347774637999*^9}, {
   3.550353512531642*^9, 3.5503535139114847`*^9}, {3.5503726867970037`*^9, 
   3.5503727456786947`*^9}, {3.5503732858077927`*^9, 3.550373312884335*^9}, {
   3.550373704412539*^9, 3.550373737107574*^9}, 3.550375362917342*^9, {
   3.550376458316873*^9, 3.5503764606919928`*^9}, {3.550376645292919*^9, 
   3.550376735372917*^9}, {3.550376766637576*^9, 3.550376795572122*^9}, {
   3.550442771820805*^9, 3.550442799789956*^9}, {3.550442856611068*^9, 
   3.5504429023130198`*^9}, {3.550443401351265*^9, 3.550443403005287*^9}, {
   3.550701233878965*^9, 3.550701290022964*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Givens", "Section",
 CellChangeTimes->{{3.549852783991269*^9, 3.5498527850934362`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Givens", "[", 
    RowBox[{"Bin_", ",", "Binn_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a", ",", "bB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Bin", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bB", "=", 
       RowBox[{"Binn", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"a", "bB"},
          {
           RowBox[{"-", "bB"}], "a"}
         }], ")"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "bB"}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Givens", "[", 
      RowBox[{
       RowBox[{"Bn", ":", 
        RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_"}], "]"}], ":=", 
     
     RowBox[{
      RowBox[{"Givens", "[", 
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "col"}], "]"}], "//", 
      "N"}]}], ";"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Givens", "[", 
     RowBox[{
      RowBox[{"Bn", ":", 
       RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", 
      "scol_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Givens", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "scol"}], "]"}], "//", 
     "N"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", "col_", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"Givens", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "col"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GivensReduce", "[", 
     RowBox[{"BDx_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_", ",", "scol_", 
      ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"Givens", "[", 
          RowBox[{
           RowBox[{"BDx", "\[LeftDoubleBracket]", 
            RowBox[{"row1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"BDx", "\[LeftDoubleBracket]", 
            RowBox[{"row2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "opts"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GivensReduce", "[", 
     RowBox[{
      RowBox[{"BDx", ":", 
       RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "scol_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"Givens", "[", 
          RowBox[{"BDx", ",", 
           RowBox[{"{", 
            RowBox[{"row1", ",", "row2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
          "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "opts"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GivensReduce", "[", 
    RowBox[{
     RowBox[{"BDx", ":", 
      RowBox[{"{", "__BandedOperator", "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", "scol_", 
     ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"ApplyToRows", "[", 
    RowBox[{
     RowBox[{"Givens", "[", 
      RowBox[{"BDx", ",", 
       RowBox[{"{", 
        RowBox[{"row1", ",", "row2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "col", ",", "scol"}], 
      "]"}], ",", "BDx", ",", 
     RowBox[{"{", 
      RowBox[{"row1", ",", "row2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549756628054965*^9, 3.549756770589405*^9}, 
   3.549822823515428*^9, {3.549826667004466*^9, 3.5498266672920227`*^9}, {
   3.5498307337308826`*^9, 3.5498308148241987`*^9}, {3.549852826370562*^9, 
   3.549852923989644*^9}, {3.549853461087563*^9, 3.5498534920722713`*^9}, {
   3.549853892662857*^9, 3.549853963029562*^9}, {3.549854300032857*^9, 
   3.549854301590097*^9}, {3.549854358701455*^9, 3.549854383645089*^9}, {
   3.550166813511777*^9, 3.5501668776717033`*^9}, {3.550183232417708*^9, 
   3.550183298642459*^9}, 3.5501833733322563`*^9, {3.55037378638031*^9, 
   3.5503738354838657`*^9}, {3.550375880268836*^9, 3.550375880927491*^9}, {
   3.550700981066902*^9, 3.550701188508637*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["RowReduce", "Section",
 CellChangeTimes->{{3.549852783991269*^9, 3.5498527850934362`*^9}, {
  3.550257529695962*^9, 3.550257530892642*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RowReduceMatrix", "[", 
    RowBox[{"Bin_", ",", "Binn_", ",", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}], ",", "k_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"A", ",", "a", ",", "bB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"Bin", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bB", "=", 
       RowBox[{"Binn", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {
          RowBox[{
           RowBox[{"-", "bB"}], "/", "a"}], "1"}
        }], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RowReduceMatrix", "[", 
     RowBox[{"Bn_", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_", ",", 
      "scol_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RowReduceMatrix", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{
        "Bn", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", 
        RowBox[{"srow2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "scol"}], "]"}], "//", 
     "N"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "row1"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "row1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "srow1"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ListRowReduce", "[", 
     RowBox[{"BDx_BandedOperator", ",", 
      RowBox[{"{", 
       RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", 
        RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"G", "=", 
        RowBox[{
         RowBox[{"RowReduceMatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow1", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{
            "BDx", "\[LeftDoubleBracket]", "row2", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"srow2", ",", "srow1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "ssrow1"}], "]"}], 
         "//", "N"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ApplyToRows", "[", 
        RowBox[{"G", ",", "BDx", ",", 
         RowBox[{"{", 
          RowBox[{"row1", ",", "row2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "opts"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", "col_Integer", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{"BDx", ",", "BDx", ",", 
          RowBox[{"{", 
           RowBox[{"row1", ",", "row2"}], "}"}], ",", "col"}], "]"}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BandedOperator", "/:", 
   RowBox[{"RowReduce", "[", 
    RowBox[{"BDx_BandedOperator", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", "col_Integer", ",", 
     "scol_Integer", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "G", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", "=", 
       RowBox[{
        RowBox[{"RowReduceMatrix", "[", 
         RowBox[{
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row1", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"BDx", "\[LeftDoubleBracket]", 
           RowBox[{"row2", ",", "col"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "scol"}], "]"}], "//",
         "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyToRows", "[", 
       RowBox[{"G", ",", "BDx", ",", 
        RowBox[{"{", 
         RowBox[{"row1", ",", "row2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"srow1", ",", "srow2"}], "}"}], ",", "opts"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListRowReduce", "[", 
    RowBox[{"BDx_", ",", 
     RowBox[{"{", 
      RowBox[{"row1_", ",", "row2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1_", ",", "srow2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1_", ",", "ssrow2_"}], "}"}], ",", "col_Integer", ",", 
     "scol_Integer", ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"RightHandSide", "\[Rule]", "Null"}], "]"}]}]}], "]"}], ":=", 
   RowBox[{"ApplyToRows", "[", 
    RowBox[{
     RowBox[{"RowReduceMatrix", "[", 
      RowBox[{"BDx", ",", 
       RowBox[{"{", 
        RowBox[{"row1", ",", "row2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "col", ",", "scol"}], 
      "]"}], ",", "BDx", ",", 
     RowBox[{"{", 
      RowBox[{"row1", ",", "row2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"srow1", ",", "srow2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ssrow1", ",", "ssrow2"}], "}"}], ",", "opts"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.549756628054965*^9, 3.549756770589405*^9}, 
   3.549822823515428*^9, {3.549826667004466*^9, 3.5498266672920227`*^9}, {
   3.5498307337308826`*^9, 3.5498308148241987`*^9}, {3.549852826370562*^9, 
   3.549852923989644*^9}, {3.549853461087563*^9, 3.5498534920722713`*^9}, {
   3.549853892662857*^9, 3.549853963029562*^9}, {3.549854300032857*^9, 
   3.549854301590097*^9}, {3.549854358701455*^9, 3.549854383645089*^9}, {
   3.550166813511777*^9, 3.5501668776717033`*^9}, {3.550183232417708*^9, 
   3.550183298642459*^9}, 3.5501833733322563`*^9, {3.55025753238282*^9, 
   3.550257753865631*^9}, {3.550257836308195*^9, 3.550257876306402*^9}, {
   3.5502579164967413`*^9, 3.5502579280317497`*^9}, {3.550258042505392*^9, 
   3.5502580659781313`*^9}, {3.550258195326816*^9, 3.550258195843938*^9}, {
   3.550375888195318*^9, 3.550375954292859*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives", "Section",
 CellChangeTimes->{{3.550117498093774*^9, 3.550117500418523*^9}}],

Cell[CellGroupData[{

Cell["1D", "Subsection",
 CellChangeTimes->{{3.550118929591868*^9, 3.5501189299263897`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "4"}], "}"}], ",", "0"}], "]"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"#", "+", "1"}], ")"}]}]}], "}"}], ",", 
        RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", "#", "}"}], ",", 
        RowBox[{"-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", "1", "]"}], ":=", 
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", "2", "]"}], ":=", 
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", "0"}], "]"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", "0", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", 
        RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", "1", "]"}], ":=", 
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"1", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConversionOperator", "[", 
    RowBox[{"2", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
          RowBox[{"1", "/", "6"}]}], "}"}], ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
           FractionBox["1", 
            RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
          FractionBox["1", 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], ",", 
        RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConversionOperator", "[", "2", "]"}], ":=", 
    RowBox[{"ConversionOperator", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DirichletOperator", "[", 
    RowBox[{"-", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", "0"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], 
           RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DirichletOperator", "[", "1", "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ShiftList", "[", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", "0"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "}"}], ",", "Null", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"#", "-", "1"}]], ",", "1"}], "}"}], "&"}], ")"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IdentityOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "0"}], "]"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IdentityOperator", "[", "]"}], ":=", 
    RowBox[{"IdentityOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"Filler", "\[Rule]", "fls_"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "0"}], "]"}], "}"}], 
     ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"1", "-", "#"}]}], "]"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroOperator", "[", 
    RowBox[{"1", ",", "\[Infinity]", ",", 
     RowBox[{"Filler", "\[Rule]", "fls_"}]}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ShiftList", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "0"}], "]"}], "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"0", " ", 
       RowBox[{"fls", "[", "1", "]"}]}], "}"}], ",", "Null", ",", 
     RowBox[{"Filler", "\[Rule]", "fls"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]"}], "]"}], ":=", 
    RowBox[{"ZeroOperator", "[", 
     RowBox[{"1", ",", "\[Infinity]", ",", 
      RowBox[{"Filler", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], "^", 
            RowBox[{"(", 
             RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
        ")"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQHXU17oJ/8SvHPoWkKyD6xSHb5yA6ovHYGxC95/fF
7yBaZMqNPyA6znArXwCQ3nJZUhxEH2r7bgeiaw61uIDoki3tHiD6FRtjFIiu
cgxOBNE/nuxJAtFSjw4yBAFpGRljRhBdxeujDKLLGtRVQLTiwldWwUD6qgir
NYiW+D3XHkT/nbwITM+QKnAG0UXC+m4gOu6xz38QXVW8lTEESOuqXGEH0Vea
3vGA6K4dAltygfSE2067QPQRZf3aIiB9Ke9qN4guk8pVzyl55ejLPEkHRK/1
5TEB0THac8xA9L7+GS4gOilgiSuIvrLlpQ+IZv15wR9ES/mqhYDo6lfHQkE0
z9lbsSCaseIhmHaqa08G0WsWutaCaAArKbJJ
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Boundary", "Subsection",
 CellChangeTimes->{{3.550118700417121*^9, 3.550118700734531*^9}, {
  3.550121793317935*^9, 3.550121794817618*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"IdentityOperator", "[", "]"}], ",", 
          RowBox[{"ZeroOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null", 
       ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"1", ",", "All"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"IdentityOperator", "[", "]"}], "}"}], "}"}], ",", "1", ",", 
       
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", "]"}], ",", 
          RowBox[{"IdentityOperator", "[", "]"}]}], "}"}], "}"}], ",", "Null",
        ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", 
       RowBox[{"-", "1"}]}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DirichletOperator", "[", 
      RowBox[{"All", ",", "1"}], "]"}], ":=", 
     RowBox[{"BandedOperator", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "}"}], ",", "1",
        ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}], ",", 
          RowBox[{"ZeroOperator", "[", 
           RowBox[{"1", ",", "\[Infinity]"}], "]"}]}], "}"}], "}"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"DirichletOperator", "[", "1", "]"}], "}"}], "&"}], ",", 
       RowBox[{"Filler", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
         ")"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550118636925847*^9, 3.550118657395903*^9}, {
  3.550118713262124*^9, 3.550118916277152*^9}, {3.550120334916541*^9, 
  3.5501203751819057`*^9}, {3.5501217701479483`*^9, 3.5501217780463*^9}, {
  3.550125933742004*^9, 3.550126072224814*^9}, {3.5501261883221197`*^9, 
  3.550126196219458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2D Derivative", "Subsection",
 CellChangeTimes->{{3.550121800768366*^9, 3.5501218029082127`*^9}, {
  3.550121980498454*^9, 3.550121981574006*^9}, {3.550122449180884*^9, 
  3.550122452090794*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"ConversionOperator", "[", "1", "]"}], "}"}], "}"}], ",", "0", 
     ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", "#", ")"}], 
        RowBox[{"ConversionOperator", "[", "1", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"1", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "1", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "1", "]"}], "/", "2"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"DerivativeOperator", "[", "1", "]"}]}], "/", "2"}]}], 
        "}"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DerivativeOperator", "[", 
    RowBox[{"0", ",", "2"}], "]"}], ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", " ", 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"{", 
      RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"#", "+", "1"}], ")"}], 
        RowBox[{"ConversionOperator", "[", "2", "]"}]}], "}"}], "&"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DerivativeOperator", "[", 
     RowBox[{"2", ",", "0"}], "]"}], ":=", 
    RowBox[{"BandedOperator", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], "/", "3"}], " ", 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
       "}"}], ",", "1", ",", 
      RowBox[{"{", 
       RowBox[{"ZeroOperator", "[", "]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", " ", "#"}], ")"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
            FractionBox["1", 
             RowBox[{"2", " ", "#"}]]}], ")"}], 
          RowBox[{"DerivativeOperator", "[", "2", "]"}]}], ",", 
         RowBox[{"ZeroOperator", "[", "]"}], ",", 
         FractionBox[
          RowBox[{"DerivativeOperator", "[", "2", "]"}], 
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaplaceOperator", ":=", 
   RowBox[{"BandedOperator", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DerivativeOperator", "[", "2", "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"4", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "/", "3"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"#", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
              "}"}]}], "+", 
            RowBox[{"4", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "#"}], ")"}]}], ",", "0", ",", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ",", "0", ",", 
               FractionBox["1", 
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}]}]}], "&"}], ",", 
          
          RowBox[{"Filler", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
            ")"}]}]}], "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", "6"}]}], "}"}], 
      "}"}], ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"DerivativeOperator", "[", "2", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "#"}], ")"}]}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        RowBox[{"BandedOperator", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                FractionBox["1", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
               FractionBox["1", 
                RowBox[{"2", " ", "#"}]]}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "4", ",", "0", ",", "0"}], "}"}]}], 
            "+", 
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"#", "+", "1"}], ")"}], 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "2"}], "/", "3"}], ",", "0", ",", 
               RowBox[{"1", "/", "6"}]}], "}"}]}]}], "}"}], ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
          RowBox[{"Function", "[", 
           RowBox[{"rw", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"#", "+", "2"}], ")"}]}]]}], "-", 
                FractionBox["1", 
                 RowBox[{"2", " ", "#"}]]}], ")"}], 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{"rw", "+", "1"}], ")"}]}], ",", "0", ",", "0"}], 
               "}"}]}], "+", 
             RowBox[{"2", 
              RowBox[{"(", 
               RowBox[{"#", "+", "1"}], ")"}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "rw"}], ")"}]}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"rw", "+", "2"}], ")"}]}]]}], "-", 
                 FractionBox["1", 
                  RowBox[{"2", " ", "rw"}]]}], ",", "0", ",", 
                FractionBox["1", 
                 RowBox[{"2", 
                  RowBox[{"(", 
                   RowBox[{"rw", "+", "2"}], ")"}]}]]}], "}"}]}]}]}], "]"}], 
          ",", 
          RowBox[{"Filler", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"-", "1"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
            ")"}]}]}], "]"}], ",", 
        RowBox[{"ZeroOperator", "[", "]"}], ",", 
        FractionBox[
         RowBox[{"DerivativeOperator", "[", "2", "]"}], 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"#", "+", "2"}], ")"}]}]]}], "}"}], "&"}], ",", 
     RowBox[{"Filler", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"#", "-", "1"}], ")"}]}], ",", "1"}], "}"}], "&"}], 
       ")"}]}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.550122452643403*^9, 3.550122480910864*^9}, {
  3.550122574777398*^9, 3.550122624935754*^9}, {3.550122657779542*^9, 
  3.550122734251135*^9}, {3.550124447345154*^9, 3.550124478636944*^9}, {
  3.5501246311602497`*^9, 3.550124676317891*^9}, {3.550124753191527*^9, 
  3.550124888158516*^9}, {3.55012495533981*^9, 3.550124957036583*^9}, {
  3.550124996059701*^9, 3.550125037266059*^9}, {3.550125085801772*^9, 
  3.550125108235787*^9}, {3.550125149534938*^9, 3.550125188195448*^9}, {
  3.550125245405364*^9, 3.550125274555833*^9}, {3.550125327605113*^9, 
  3.5501253976174927`*^9}, {3.550125431562579*^9, 3.5501254394278297`*^9}, {
  3.550125706552293*^9, 3.550125706916587*^9}, {3.550126203868326*^9, 
  3.550126249079026*^9}, {3.550190374550264*^9, 3.550190397382245*^9}, {
  3.5501905449613533`*^9, 3.5501905618263063`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finish", "Section",
 CellChangeTimes->{{3.549774023871806*^9, 3.549774024517992*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5497740258052588`*^9, 3.54977403320975*^9}}]
}, Open  ]]
},
WindowSize->{529, 823},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 90, 1, 67, "Section"],
Cell[672, 25, 2425, 42, 418, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3134, 72, 150, 2, 67, "Section"],
Cell[3287, 76, 11992, 323, 1108, "Input",
 InitializationCell->True],
Cell[15282, 401, 15435, 362, 1753, "Input",
 InitializationCell->True],
Cell[30720, 765, 5445, 141, 628, "Input",
 InitializationCell->True],
Cell[36168, 908, 67, 1, 27, "Input"],
Cell[36238, 911, 197, 3, 58, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36472, 919, 101, 1, 67, "Section"],
Cell[36576, 922, 10334, 271, 853, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46947, 1198, 107, 1, 37, "Section"],
Cell[47057, 1201, 16848, 417, 1213, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[63942, 1623, 182, 4, 37, "Section"],
Cell[64127, 1629, 91, 1, 27, "Input"],
Cell[64221, 1632, 94, 1, 27, "Input"],
Cell[64318, 1635, 14210, 329, 1213, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[78565, 1969, 93, 1, 67, "Section"],
Cell[78661, 1972, 8464, 228, 491, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[87162, 2205, 145, 2, 67, "Section"],
Cell[87310, 2209, 10406, 263, 611, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[97753, 2477, 96, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[97874, 2482, 92, 1, 34, "Subsection"],
Cell[97969, 2485, 11442, 359, 449, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[109448, 2849, 148, 2, 34, "Subsection"],
Cell[109599, 2853, 4387, 127, 163, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[114023, 2985, 201, 3, 34, "Subsection"],
Cell[114227, 2990, 11363, 313, 497, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125639, 3309, 91, 1, 67, "Section"],
Cell[125733, 3312, 242, 6, 43, "Input",
 InitializationCell->True]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
